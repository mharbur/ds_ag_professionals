<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 14 Putting it all Together | Data Science for Agricultural Professionals</title>
  <meta name="description" content="Practical statistics for those involved in agronomy and related agricultural sciences." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 14 Putting it all Together | Data Science for Agricultural Professionals" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://mharbur.github.io/data-science-for-agricultural-professionals/" />
  
  <meta property="og:description" content="Practical statistics for those involved in agronomy and related agricultural sciences." />
  <meta name="github-repo" content="https://github.com/mharbur/ds_ag_professionals" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 14 Putting it all Together | Data Science for Agricultural Professionals" />
  
  <meta name="twitter:description" content="Practical statistics for those involved in agronomy and related agricultural sciences." />
  

<meta name="author" content="Marin L. Harbur" />


<meta name="date" content="2022-08-19" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="machine-learning.html"/>

<script src="libs/header-attrs-2.14/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.5.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data Science for Agricultural Professionals</a></li>

<li class="divider"></li>
<li><a href="index.html#preface">Preface<span></span></a>
<ul>
<li><a href="index.html#welcome">Welcome<span></span></a></li>
<li><a href="index.html#r-language">R-language<span></span></a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="population-statistics.html"><a href="population-statistics.html"><i class="fa fa-check"></i><b>1</b> Population Statistics<span></span></a>
<ul>
<li class="chapter" data-level="1.1" data-path="population-statistics.html"><a href="population-statistics.html#populations"><i class="fa fa-check"></i><b>1.1</b> Populations<span></span></a></li>
<li class="chapter" data-level="1.2" data-path="population-statistics.html"><a href="population-statistics.html#case-study-yield-map"><i class="fa fa-check"></i><b>1.2</b> Case Study: Yield Map<span></span></a></li>
<li class="chapter" data-level="1.3" data-path="population-statistics.html"><a href="population-statistics.html#distributions"><i class="fa fa-check"></i><b>1.3</b> Distributions<span></span></a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="population-statistics.html"><a href="population-statistics.html#histograms"><i class="fa fa-check"></i><b>1.3.1</b> Histograms<span></span></a></li>
<li class="chapter" data-level="1.3.2" data-path="population-statistics.html"><a href="population-statistics.html#percentiles"><i class="fa fa-check"></i><b>1.3.2</b> Percentiles<span></span></a></li>
<li class="chapter" data-level="1.3.3" data-path="population-statistics.html"><a href="population-statistics.html#normal-distribution-model"><i class="fa fa-check"></i><b>1.3.3</b> Normal Distribution Model<span></span></a></li>
<li class="chapter" data-level="1.3.4" data-path="population-statistics.html"><a href="population-statistics.html#measures-of-center"><i class="fa fa-check"></i><b>1.3.4</b> Measures of Center<span></span></a></li>
<li class="chapter" data-level="1.3.5" data-path="population-statistics.html"><a href="population-statistics.html#measures-of-dispersion"><i class="fa fa-check"></i><b>1.3.5</b> Measures of Dispersion<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="distributions-and-probability.html"><a href="distributions-and-probability.html"><i class="fa fa-check"></i><b>2</b> Distributions and Probability<span></span></a>
<ul>
<li class="chapter" data-level="2.1" data-path="distributions-and-probability.html"><a href="distributions-and-probability.html#case-study"><i class="fa fa-check"></i><b>2.1</b> Case Study<span></span></a></li>
<li class="chapter" data-level="2.2" data-path="distributions-and-probability.html"><a href="distributions-and-probability.html#the-normal-distribution-model"><i class="fa fa-check"></i><b>2.2</b> The Normal Distribution Model<span></span></a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="distributions-and-probability.html"><a href="distributions-and-probability.html#the-bell-curve"><i class="fa fa-check"></i><b>2.2.1</b> The Bell Curve<span></span></a></li>
<li class="chapter" data-level="2.2.2" data-path="distributions-and-probability.html"><a href="distributions-and-probability.html#distribution-and-probability"><i class="fa fa-check"></i><b>2.2.2</b> Distribution and Probability<span></span></a></li>
<li class="chapter" data-level="2.2.3" data-path="distributions-and-probability.html"><a href="distributions-and-probability.html#probability-and-the-normal-distribution-curve"><i class="fa fa-check"></i><b>2.2.3</b> Probability and the Normal Distribution Curve<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="distributions-and-probability.html"><a href="distributions-and-probability.html#the-z-distribution"><i class="fa fa-check"></i><b>2.3</b> The Z-Distribution<span></span></a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="distributions-and-probability.html"><a href="distributions-and-probability.html#important-numbers-95-and-5"><i class="fa fa-check"></i><b>2.3.1</b> Important Numbers: 95% and 5%<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="sample-statistics.html"><a href="sample-statistics.html"><i class="fa fa-check"></i><b>3</b> Sample Statistics<span></span></a>
<ul>
<li class="chapter" data-level="3.1" data-path="sample-statistics.html"><a href="sample-statistics.html#samples"><i class="fa fa-check"></i><b>3.1</b> Samples<span></span></a></li>
<li class="chapter" data-level="3.2" data-path="sample-statistics.html"><a href="sample-statistics.html#case-study-1"><i class="fa fa-check"></i><b>3.2</b> Case Study<span></span></a></li>
<li class="chapter" data-level="3.3" data-path="sample-statistics.html"><a href="sample-statistics.html#distribution-of-sample-means"><i class="fa fa-check"></i><b>3.3</b> Distribution of Sample Means<span></span></a></li>
<li class="chapter" data-level="3.4" data-path="sample-statistics.html"><a href="sample-statistics.html#central-limit-theorem"><i class="fa fa-check"></i><b>3.4</b> Central Limit Theorem<span></span></a></li>
<li class="chapter" data-level="3.5" data-path="sample-statistics.html"><a href="sample-statistics.html#standard-error"><i class="fa fa-check"></i><b>3.5</b> Standard Error<span></span></a></li>
<li class="chapter" data-level="3.6" data-path="sample-statistics.html"><a href="sample-statistics.html#degrees-of-freedom"><i class="fa fa-check"></i><b>3.6</b> Degrees of Freedom<span></span></a></li>
<li class="chapter" data-level="3.7" data-path="sample-statistics.html"><a href="sample-statistics.html#the-t-distribution"><i class="fa fa-check"></i><b>3.7</b> The t-Distribution<span></span></a></li>
<li class="chapter" data-level="3.8" data-path="sample-statistics.html"><a href="sample-statistics.html#confidence-interval"><i class="fa fa-check"></i><b>3.8</b> Confidence Interval<span></span></a></li>
<li class="chapter" data-level="3.9" data-path="sample-statistics.html"><a href="sample-statistics.html#confidence-interval-and-probability"><i class="fa fa-check"></i><b>3.9</b> Confidence Interval and Probability<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html"><i class="fa fa-check"></i><b>4</b> Two-Treatment Comparisons<span></span></a>
<ul>
<li class="chapter" data-level="4.1" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html#side-by-side-trials"><i class="fa fa-check"></i><b>4.1</b> Side-by-Side Trials<span></span></a></li>
<li class="chapter" data-level="4.2" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html#blocked-design"><i class="fa fa-check"></i><b>4.2</b> Blocked Design<span></span></a></li>
<li class="chapter" data-level="4.3" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html#case-study-2"><i class="fa fa-check"></i><b>4.3</b> Case Study<span></span></a></li>
<li class="chapter" data-level="4.4" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html#confidence-interval-1"><i class="fa fa-check"></i><b>4.4</b> Confidence Interval<span></span></a></li>
<li class="chapter" data-level="4.5" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html#t-test"><i class="fa fa-check"></i><b>4.5</b> T-Test<span></span></a></li>
<li class="chapter" data-level="4.6" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html#conclusion"><i class="fa fa-check"></i><b>4.6</b> Conclusion<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="understanding-statistical-tests.html"><a href="understanding-statistical-tests.html"><i class="fa fa-check"></i><b>5</b> Understanding Statistical Tests<span></span></a>
<ul>
<li class="chapter" data-level="5.1" data-path="understanding-statistical-tests.html"><a href="understanding-statistical-tests.html#research-question"><i class="fa fa-check"></i><b>5.1</b> Research Question<span></span></a></li>
<li class="chapter" data-level="5.2" data-path="understanding-statistical-tests.html"><a href="understanding-statistical-tests.html#the-model"><i class="fa fa-check"></i><b>5.2</b> The Model<span></span></a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="understanding-statistical-tests.html"><a href="understanding-statistical-tests.html#treatment-effect"><i class="fa fa-check"></i><b>5.2.1</b> Treatment Effect<span></span></a></li>
<li class="chapter" data-level="5.2.2" data-path="understanding-statistical-tests.html"><a href="understanding-statistical-tests.html#error-effect"><i class="fa fa-check"></i><b>5.2.2</b> Error Effect<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="understanding-statistical-tests.html"><a href="understanding-statistical-tests.html#hypotheses"><i class="fa fa-check"></i><b>5.3</b> Hypotheses<span></span></a></li>
<li class="chapter" data-level="5.4" data-path="understanding-statistical-tests.html"><a href="understanding-statistical-tests.html#p-value"><i class="fa fa-check"></i><b>5.4</b> P-Value<span></span></a></li>
<li class="chapter" data-level="5.5" data-path="understanding-statistical-tests.html"><a href="understanding-statistical-tests.html#the-p-value-and-errors"><i class="fa fa-check"></i><b>5.5</b> The P-Value and Errors<span></span></a></li>
<li class="chapter" data-level="5.6" data-path="understanding-statistical-tests.html"><a href="understanding-statistical-tests.html#one-sided-vs-two-sided-hypotheses"><i class="fa fa-check"></i><b>5.6</b> One-Sided vs Two-Sided Hypotheses<span></span></a></li>
<li class="chapter" data-level="5.7" data-path="understanding-statistical-tests.html"><a href="understanding-statistical-tests.html#exercise-linear-additive-model"><i class="fa fa-check"></i><b>5.7</b> Exercise: Linear Additive Model<span></span></a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="understanding-statistical-tests.html"><a href="understanding-statistical-tests.html#case-study-barley-effects"><i class="fa fa-check"></i><b>5.7.1</b> Case Study: Barley Effects<span></span></a></li>
<li class="chapter" data-level="5.7.2" data-path="understanding-statistical-tests.html"><a href="understanding-statistical-tests.html#plotting-the-effects"><i class="fa fa-check"></i><b>5.7.2</b> Plotting the Effects<span></span></a></li>
<li class="chapter" data-level="5.7.3" data-path="understanding-statistical-tests.html"><a href="understanding-statistical-tests.html#examining-individual-plots"><i class="fa fa-check"></i><b>5.7.3</b> Examining Individual Plots<span></span></a></li>
<li class="chapter" data-level="5.7.4" data-path="understanding-statistical-tests.html"><a href="understanding-statistical-tests.html#practice-groudnut"><i class="fa fa-check"></i><b>5.7.4</b> Practice: Groudnut<span></span></a></li>
<li class="chapter" data-level="5.7.5" data-path="understanding-statistical-tests.html"><a href="understanding-statistical-tests.html#plotting-the-effects-1"><i class="fa fa-check"></i><b>5.7.5</b> Plotting the Effects<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="understanding-statistical-tests.html"><a href="understanding-statistical-tests.html#exercise-one-sided-hypotheses"><i class="fa fa-check"></i><b>5.8</b> Exercise: One-Sided Hypotheses<span></span></a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="understanding-statistical-tests.html"><a href="understanding-statistical-tests.html#case-study-groundnut"><i class="fa fa-check"></i><b>5.8.1</b> Case Study: Groundnut<span></span></a></li>
<li class="chapter" data-level="5.8.2" data-path="understanding-statistical-tests.html"><a href="understanding-statistical-tests.html#one-sided-t-test"><i class="fa fa-check"></i><b>5.8.2</b> One-Sided T-Test<span></span></a></li>
<li class="chapter" data-level="5.8.3" data-path="understanding-statistical-tests.html"><a href="understanding-statistical-tests.html#practice-barley"><i class="fa fa-check"></i><b>5.8.3</b> Practice: Barley<span></span></a></li>
<li class="chapter" data-level="5.8.4" data-path="understanding-statistical-tests.html"><a href="understanding-statistical-tests.html#practice-strawberry"><i class="fa fa-check"></i><b>5.8.4</b> Practice: Strawberry<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="understanding-statistical-tests.html"><a href="understanding-statistical-tests.html#exercise-type-i-and-type-ii-errors"><i class="fa fa-check"></i><b>5.9</b> Exercise: Type I and Type II Errors<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html"><i class="fa fa-check"></i><b>6</b> Multiple Treatment Trials<span></span></a>
<ul>
<li class="chapter" data-level="6.1" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#case-study-3"><i class="fa fa-check"></i><b>6.1</b> Case Study<span></span></a></li>
<li class="chapter" data-level="6.2" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#the-linear-additive-model"><i class="fa fa-check"></i><b>6.2</b> The Linear Additive Model<span></span></a></li>
<li class="chapter" data-level="6.3" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#analysis-of-variance"><i class="fa fa-check"></i><b>6.3</b> Analysis of Variance<span></span></a></li>
<li class="chapter" data-level="6.4" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#the-f-statistic"><i class="fa fa-check"></i><b>6.4</b> The F statistic<span></span></a></li>
<li class="chapter" data-level="6.5" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#the-anova-table"><i class="fa fa-check"></i><b>6.5</b> The ANOVA Table<span></span></a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#source-of-variation"><i class="fa fa-check"></i><b>6.5.1</b> Source of Variation<span></span></a></li>
<li class="chapter" data-level="6.5.2" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#sum-of-squares-1"><i class="fa fa-check"></i><b>6.5.2</b> Sum of Squares<span></span></a></li>
<li class="chapter" data-level="6.5.3" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#degrees-of-freedom-1"><i class="fa fa-check"></i><b>6.5.3</b> Degrees of Freedom<span></span></a></li>
<li class="chapter" data-level="6.5.4" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#mean-square"><i class="fa fa-check"></i><b>6.5.4</b> Mean Square<span></span></a></li>
<li class="chapter" data-level="6.5.5" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#f-value"><i class="fa fa-check"></i><b>6.5.5</b> F-Value<span></span></a></li>
<li class="chapter" data-level="6.5.6" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#p-value-1"><i class="fa fa-check"></i><b>6.5.6</b> P-value<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#visualizing-how-the-anova-table-relates-to-variance"><i class="fa fa-check"></i><b>6.6</b> Visualizing How the Anova Table Relates to Variance<span></span></a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#case-study-barley"><i class="fa fa-check"></i><b>6.6.1</b> Case Study: Barley<span></span></a></li>
<li class="chapter" data-level="6.6.2" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#anova"><i class="fa fa-check"></i><b>6.6.2</b> ANOVA<span></span></a></li>
<li class="chapter" data-level="6.6.3" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#calculating-the-coefficient-of-variation"><i class="fa fa-check"></i><b>6.6.3</b> Calculating the Coefficient of Variation<span></span></a></li>
<li class="chapter" data-level="6.6.4" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#practice-beet-data"><i class="fa fa-check"></i><b>6.6.4</b> Practice: Beet Data<span></span></a></li>
<li class="chapter" data-level="6.6.5" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#practice-potato-data"><i class="fa fa-check"></i><b>6.6.5</b> Practice: Potato Data<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#exercise-treatment-means"><i class="fa fa-check"></i><b>6.7</b> Exercise: “Treatment Means”<span></span></a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#case-study-barley-1"><i class="fa fa-check"></i><b>6.7.1</b> Case Study: Barley<span></span></a></li>
<li class="chapter" data-level="6.7.2" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#calculating-treatment-means"><i class="fa fa-check"></i><b>6.7.2</b> Calculating Treatment Means<span></span></a></li>
<li class="chapter" data-level="6.7.3" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#plotting-the-means"><i class="fa fa-check"></i><b>6.7.3</b> Plotting the Means<span></span></a></li>
<li class="chapter" data-level="6.7.4" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#practice-beet-data-1"><i class="fa fa-check"></i><b>6.7.4</b> Practice: Beet Data<span></span></a></li>
<li class="chapter" data-level="6.7.5" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#practice-potato-data-1"><i class="fa fa-check"></i><b>6.7.5</b> Practice: Potato Data<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html"><i class="fa fa-check"></i><b>7</b> Multiple Treatment Designs<span></span></a>
<ul>
<li class="chapter" data-level="7.1" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#randomized-complete-block-design"><i class="fa fa-check"></i><b>7.1</b> Randomized Complete Block Design<span></span></a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#case-study-randomized-complete-block-design"><i class="fa fa-check"></i><b>7.1.1</b> Case Study: Randomized Complete Block Design<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#factorial-design"><i class="fa fa-check"></i><b>7.2</b> Factorial Design<span></span></a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#case-study-1-1"><i class="fa fa-check"></i><b>7.2.1</b> Case Study 1<span></span></a></li>
<li class="chapter" data-level="7.2.2" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#case-study-2-1"><i class="fa fa-check"></i><b>7.2.2</b> Case Study 2<span></span></a></li>
<li class="chapter" data-level="7.2.3" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#discussing-interactions"><i class="fa fa-check"></i><b>7.2.3</b> Discussing Interactions<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#split-plot-design"><i class="fa fa-check"></i><b>7.3</b> Split-Plot Design<span></span></a></li>
<li class="chapter" data-level="7.4" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#linear-additive-model-3"><i class="fa fa-check"></i><b>7.4</b> Linear Additive Model<span></span></a></li>
<li class="chapter" data-level="7.5" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#conclusion-1"><i class="fa fa-check"></i><b>7.5</b> Conclusion<span></span></a></li>
<li class="chapter" data-level="7.6" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#exercise-randomized-complete-block-design"><i class="fa fa-check"></i><b>7.6</b> Exercise: Randomized Complete Block Design<span></span></a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#case-study-4"><i class="fa fa-check"></i><b>7.6.1</b> Case Study<span></span></a></li>
<li class="chapter" data-level="7.6.2" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#anova-1"><i class="fa fa-check"></i><b>7.6.2</b> ANOVA<span></span></a></li>
<li class="chapter" data-level="7.6.3" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#plotting-the-results"><i class="fa fa-check"></i><b>7.6.3</b> Plotting the Results<span></span></a></li>
<li class="chapter" data-level="7.6.4" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#practice"><i class="fa fa-check"></i><b>7.6.4</b> Practice<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#exercise-factorial-anova"><i class="fa fa-check"></i><b>7.7</b> Exercise: Factorial ANOVA<span></span></a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#case-study-biochar"><i class="fa fa-check"></i><b>7.7.1</b> Case Study: Biochar<span></span></a></li>
<li class="chapter" data-level="7.7.2" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#anova-2"><i class="fa fa-check"></i><b>7.7.2</b> ANOVA<span></span></a></li>
<li class="chapter" data-level="7.7.3" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#interaction-plots"><i class="fa fa-check"></i><b>7.7.3</b> Interaction Plots<span></span></a></li>
<li class="chapter" data-level="7.7.4" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#testing-factors-individually"><i class="fa fa-check"></i><b>7.7.4</b> Testing Factors Individually<span></span></a></li>
<li class="chapter" data-level="7.7.5" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#bar-plots"><i class="fa fa-check"></i><b>7.7.5</b> Bar Plots<span></span></a></li>
<li class="chapter" data-level="7.7.6" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#practice-1"><i class="fa fa-check"></i><b>7.7.6</b> Practice<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#exercise-split-plot-design"><i class="fa fa-check"></i><b>7.8</b> Exercise: Split-Plot Design<span></span></a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#case-study-corn-soybean-systems-trial"><i class="fa fa-check"></i><b>7.8.1</b> Case Study: Corn-Soybean Systems Trial<span></span></a></li>
<li class="chapter" data-level="7.8.2" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#anova-4"><i class="fa fa-check"></i><b>7.8.2</b> ANOVA<span></span></a></li>
<li class="chapter" data-level="7.8.3" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#interaction-plot"><i class="fa fa-check"></i><b>7.8.3</b> Interaction Plot<span></span></a></li>
<li class="chapter" data-level="7.8.4" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#bar-plot"><i class="fa fa-check"></i><b>7.8.4</b> Bar plot<span></span></a></li>
<li class="chapter" data-level="7.8.5" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#practice-2"><i class="fa fa-check"></i><b>7.8.5</b> Practice<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#exercise-experimental-design"><i class="fa fa-check"></i><b>7.9</b> Exercise: Experimental Design<span></span></a>
<ul>
<li class="chapter" data-level="7.9.1" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#completely-randomized-design"><i class="fa fa-check"></i><b>7.9.1</b> Completely Randomized Design<span></span></a></li>
<li class="chapter" data-level="7.9.2" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#randomized-complete-block-design-1"><i class="fa fa-check"></i><b>7.9.2</b> Randomized Complete Block Design<span></span></a></li>
<li class="chapter" data-level="7.9.3" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#factorial-design-1"><i class="fa fa-check"></i><b>7.9.3</b> Factorial Design<span></span></a></li>
<li class="chapter" data-level="7.9.4" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#split-plot-design-1"><i class="fa fa-check"></i><b>7.9.4</b> Split-Plot Design<span></span></a></li>
<li class="chapter" data-level="7.9.5" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#practice-3"><i class="fa fa-check"></i><b>7.9.5</b> Practice<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html"><i class="fa fa-check"></i><b>8</b> Means Separation and Data Presentation<span></span></a>
<ul>
<li class="chapter" data-level="8.1" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#case-study-5"><i class="fa fa-check"></i><b>8.1</b> Case Study<span></span></a></li>
<li class="chapter" data-level="8.2" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#least-significant-difference"><i class="fa fa-check"></i><b>8.2</b> Least Significant Difference<span></span></a></li>
<li class="chapter" data-level="8.3" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#lsd-output-in-r"><i class="fa fa-check"></i><b>8.3</b> LSD Output in R<span></span></a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#statistics-table"><i class="fa fa-check"></i><b>8.3.1</b> Statistics Table<span></span></a></li>
<li class="chapter" data-level="8.3.2" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#means-table"><i class="fa fa-check"></i><b>8.3.2</b> Means Table<span></span></a></li>
<li class="chapter" data-level="8.3.3" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#groups-table"><i class="fa fa-check"></i><b>8.3.3</b> Groups Table<span></span></a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#comparisonwise-versus-experimentwise-error"><i class="fa fa-check"></i><b>8.4</b> Comparisonwise versus Experimentwise Error<span></span></a></li>
<li class="chapter" data-level="8.5" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#tukeys-honest-significant-difference"><i class="fa fa-check"></i><b>8.5</b> Tukey’s Honest Significant Difference<span></span></a></li>
<li class="chapter" data-level="8.6" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#linear-contrast"><i class="fa fa-check"></i><b>8.6</b> Linear Contrast<span></span></a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#coefficients"><i class="fa fa-check"></i><b>8.6.1</b> Coefficients<span></span></a></li>
<li class="chapter" data-level="8.6.2" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#linear-contrasts-with-r"><i class="fa fa-check"></i><b>8.6.2</b> Linear Contrasts with R<span></span></a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#means-presentation"><i class="fa fa-check"></i><b>8.7</b> Means Presentation<span></span></a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#means-tables"><i class="fa fa-check"></i><b>8.7.1</b> Means Tables<span></span></a></li>
<li class="chapter" data-level="8.7.2" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#plotting-means"><i class="fa fa-check"></i><b>8.7.2</b> Plotting Means<span></span></a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#exercise-lsd-and-tukeys-hsd"><i class="fa fa-check"></i><b>8.8</b> Exercise: LSD and Tukey’s HSD<span></span></a>
<ul>
<li class="chapter" data-level="8.8.1" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#case-study-common-bean"><i class="fa fa-check"></i><b>8.8.1</b> Case Study: Common Bean<span></span></a></li>
<li class="chapter" data-level="8.8.2" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#least-significant-difference-1"><i class="fa fa-check"></i><b>8.8.2</b> Least Significant Difference<span></span></a></li>
<li class="chapter" data-level="8.8.3" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#tukey-hsd"><i class="fa fa-check"></i><b>8.8.3</b> Tukey HSD<span></span></a></li>
<li class="chapter" data-level="8.8.4" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#practice-apple"><i class="fa fa-check"></i><b>8.8.4</b> Practice: Apple<span></span></a></li>
<li class="chapter" data-level="8.8.5" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#practice-wheat-treatment-with-mildew"><i class="fa fa-check"></i><b>8.8.5</b> Practice: Wheat Treatment with Mildew<span></span></a></li>
</ul></li>
<li class="chapter" data-level="8.9" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#exercise-linear-contrasts"><i class="fa fa-check"></i><b>8.9</b> Exercise: Linear Contrasts<span></span></a>
<ul>
<li class="chapter" data-level="8.9.1" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#case-study-winter-canola-cultivar-trial."><i class="fa fa-check"></i><b>8.9.1</b> Case Study: Winter Canola Cultivar Trial.<span></span></a></li>
<li class="chapter" data-level="8.9.2" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#running-the-contrast"><i class="fa fa-check"></i><b>8.9.2</b> Running the Contrast<span></span></a></li>
<li class="chapter" data-level="8.9.3" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#practice-corn-nitrogen-source-and-timing"><i class="fa fa-check"></i><b>8.9.3</b> Practice: Corn Nitrogen Source and Timing<span></span></a></li>
</ul></li>
<li class="chapter" data-level="8.10" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#exercise-means-tables"><i class="fa fa-check"></i><b>8.10</b> Exercise: Means Tables<span></span></a>
<ul>
<li class="chapter" data-level="8.10.1" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#case-study-corn-nitrogen-source-and-timing"><i class="fa fa-check"></i><b>8.10.1</b> Case Study: Corn Nitrogen Source and Timing<span></span></a></li>
<li class="chapter" data-level="8.10.2" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#practice-canola"><i class="fa fa-check"></i><b>8.10.2</b> Practice: Canola<span></span></a></li>
<li class="chapter" data-level="8.10.3" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#practice-broccoli-lsd"><i class="fa fa-check"></i><b>8.10.3</b> Practice: Broccoli LSD<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html"><i class="fa fa-check"></i><b>9</b> Messy and Missing Data<span></span></a>
<ul>
<li class="chapter" data-level="9.1" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#inspecting-data-for-normal-distributions"><i class="fa fa-check"></i><b>9.1</b> Inspecting data for Normal Distributions<span></span></a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#histograms-1"><i class="fa fa-check"></i><b>9.1.1</b> Histograms<span></span></a></li>
<li class="chapter" data-level="9.1.2" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#rank-percentile-plots"><i class="fa fa-check"></i><b>9.1.2</b> Rank Percentile Plots<span></span></a></li>
<li class="chapter" data-level="9.1.3" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#box-plots"><i class="fa fa-check"></i><b>9.1.3</b> Box Plots<span></span></a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#inspecting-data-for-equal-variances"><i class="fa fa-check"></i><b>9.2</b> Inspecting Data for Equal Variances<span></span></a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#mean-variance-plot"><i class="fa fa-check"></i><b>9.2.1</b> Mean-Variance Plot<span></span></a></li>
<li class="chapter" data-level="9.2.2" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#homogeneity-of-variance-tests"><i class="fa fa-check"></i><b>9.2.2</b> Homogeneity of Variance Tests<span></span></a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#dealing-with-messy-data"><i class="fa fa-check"></i><b>9.3</b> Dealing with Messy Data<span></span></a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#outliers"><i class="fa fa-check"></i><b>9.3.1</b> Outliers<span></span></a></li>
<li class="chapter" data-level="9.3.2" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#non-normal-data-and-unequal-variances"><i class="fa fa-check"></i><b>9.3.2</b> Non-normal Data and Unequal Variances<span></span></a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#dealing-with-missing-data"><i class="fa fa-check"></i><b>9.4</b> Dealing with Missing Data<span></span></a></li>
<li class="chapter" data-level="9.5" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#summary"><i class="fa fa-check"></i><b>9.5</b> Summary<span></span></a></li>
<li class="chapter" data-level="9.6" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#exercise-visual-data-inspection"><i class="fa fa-check"></i><b>9.6</b> Exercise: Visual Data Inspection<span></span></a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#case-study-1-2"><i class="fa fa-check"></i><b>9.6.1</b> Case Study 1<span></span></a></li>
<li class="chapter" data-level="9.6.2" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#histogram"><i class="fa fa-check"></i><b>9.6.2</b> Histogram<span></span></a></li>
<li class="chapter" data-level="9.6.3" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#rank-percentile"><i class="fa fa-check"></i><b>9.6.3</b> Rank-Percentile<span></span></a></li>
<li class="chapter" data-level="9.6.4" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#case-study-2-2"><i class="fa fa-check"></i><b>9.6.4</b> Case Study 2<span></span></a></li>
<li class="chapter" data-level="9.6.5" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#box-plot"><i class="fa fa-check"></i><b>9.6.5</b> Box Plot<span></span></a></li>
<li class="chapter" data-level="9.6.6" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#practice-4"><i class="fa fa-check"></i><b>9.6.6</b> Practice<span></span></a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#exercise-identifying-unequal-variances"><i class="fa fa-check"></i><b>9.7</b> Exercise: Identifying Unequal Variances”<span></span></a>
<ul>
<li class="chapter" data-level="9.7.1" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#case-study-grape-colapsis-in-seed-corn"><i class="fa fa-check"></i><b>9.7.1</b> Case Study: Grape Colapsis in Seed Corn<span></span></a></li>
<li class="chapter" data-level="9.7.2" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#practice-pigweed-height"><i class="fa fa-check"></i><b>9.7.2</b> Practice: Pigweed Height<span></span></a></li>
</ul></li>
<li class="chapter" data-level="9.8" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#exercise-transforming-and-analyzing-data"><i class="fa fa-check"></i><b>9.8</b> Exercise: Transforming and Analyzing Data<span></span></a>
<ul>
<li class="chapter" data-level="9.8.1" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#case-study-grape-colapsis-in-seed-corn-1"><i class="fa fa-check"></i><b>9.8.1</b> Case Study: Grape Colapsis in Seed Corn<span></span></a></li>
<li class="chapter" data-level="9.8.2" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#practice-pigweed-height-1"><i class="fa fa-check"></i><b>9.8.2</b> Practice: Pigweed Height<span></span></a></li>
<li class="chapter" data-level="9.8.3" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#practice-pigweed-biomass"><i class="fa fa-check"></i><b>9.8.3</b> Practice: Pigweed Biomass<span></span></a></li>
</ul></li>
<li class="chapter" data-level="9.9" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#exercise-imputing-missing-data"><i class="fa fa-check"></i><b>9.9</b> Exercise: Imputing Missing Data<span></span></a>
<ul>
<li class="chapter" data-level="9.9.1" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#case-study-wheat-genotype-trial"><i class="fa fa-check"></i><b>9.9.1</b> Case Study: Wheat Genotype Trial<span></span></a></li>
<li class="chapter" data-level="9.9.2" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#practice-1-1"><i class="fa fa-check"></i><b>9.9.2</b> Practice 1<span></span></a></li>
<li class="chapter" data-level="9.9.3" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#practice-2-1"><i class="fa fa-check"></i><b>9.9.3</b> Practice 2<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html"><i class="fa fa-check"></i><b>10</b> Correlation and Simple Regression<span></span></a>
<ul>
<li class="chapter" data-level="10.1" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#correlation"><i class="fa fa-check"></i><b>10.1</b> Correlation<span></span></a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#case-study-cucumber"><i class="fa fa-check"></i><b>10.1.1</b> Case Study: Cucumber<span></span></a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#correlation-1"><i class="fa fa-check"></i><b>10.2</b> Correlation<span></span></a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#how-is-r-calcuated-optional-reading"><i class="fa fa-check"></i><b>10.2.1</b> How Is r Calcuated (optional reading)<span></span></a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#regression"><i class="fa fa-check"></i><b>10.3</b> Regression<span></span></a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#case-study-6"><i class="fa fa-check"></i><b>10.3.1</b> Case Study<span></span></a></li>
<li class="chapter" data-level="10.3.2" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#linear-equation"><i class="fa fa-check"></i><b>10.3.2</b> Linear Equation<span></span></a></li>
<li class="chapter" data-level="10.3.3" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#calculating-the-regression-equation"><i class="fa fa-check"></i><b>10.3.3</b> Calculating the Regression Equation<span></span></a></li>
<li class="chapter" data-level="10.3.4" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#least-squares-estimate"><i class="fa fa-check"></i><b>10.3.4</b> Least-Squares Estimate<span></span></a></li>
<li class="chapter" data-level="10.3.5" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#significance-of-coefficients"><i class="fa fa-check"></i><b>10.3.5</b> Significance of Coefficients<span></span></a></li>
<li class="chapter" data-level="10.3.6" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#analysis-of-variance-6"><i class="fa fa-check"></i><b>10.3.6</b> Analysis of Variance<span></span></a></li>
<li class="chapter" data-level="10.3.7" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#measuring-model-fit-with-r-square"><i class="fa fa-check"></i><b>10.3.7</b> Measuring Model Fit with R-Square<span></span></a></li>
<li class="chapter" data-level="10.3.8" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#checking-whether-the-linear-model-is-appropriate"><i class="fa fa-check"></i><b>10.3.8</b> Checking whether the Linear Model is Appropriate<span></span></a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#extrapolation"><i class="fa fa-check"></i><b>10.4</b> Extrapolation<span></span></a></li>
<li class="chapter" data-level="10.5" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#exercise-sccatterplots-and-regression"><i class="fa fa-check"></i><b>10.5</b> Exercise: Sccatterplots and Regression<span></span></a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#case-study-corn-data"><i class="fa fa-check"></i><b>10.5.1</b> Case Study: Corn Data<span></span></a></li>
<li class="chapter" data-level="10.5.2" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#practice-1-2"><i class="fa fa-check"></i><b>10.5.2</b> Practice 1<span></span></a></li>
<li class="chapter" data-level="10.5.3" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#practice-2-2"><i class="fa fa-check"></i><b>10.5.3</b> Practice 2<span></span></a></li>
<li class="chapter" data-level="10.5.4" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#practice-3-1"><i class="fa fa-check"></i><b>10.5.4</b> Practice 3<span></span></a></li>
<li class="chapter" data-level="10.5.5" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#practice-4-1"><i class="fa fa-check"></i><b>10.5.5</b> Practice 4<span></span></a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#exercise-simple-linear-regression"><i class="fa fa-check"></i><b>10.6</b> Exercise: Simple Linear Regression<span></span></a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#case-study-corn-allometry"><i class="fa fa-check"></i><b>10.6.1</b> Case Study: Corn Allometry<span></span></a></li>
<li class="chapter" data-level="10.6.2" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#fitting-the-regression-model"><i class="fa fa-check"></i><b>10.6.2</b> Fitting the regression model<span></span></a></li>
<li class="chapter" data-level="10.6.3" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#examining-the-residuals"><i class="fa fa-check"></i><b>10.6.3</b> Examining the residuals<span></span></a></li>
<li class="chapter" data-level="10.6.4" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#viewing-the-model-coefficients"><i class="fa fa-check"></i><b>10.6.4</b> Viewing the Model Coefficients<span></span></a></li>
<li class="chapter" data-level="10.6.5" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#more-measures-of-model-fit"><i class="fa fa-check"></i><b>10.6.5</b> More measures of model fit<span></span></a></li>
<li class="chapter" data-level="10.6.6" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#practice-1-3"><i class="fa fa-check"></i><b>10.6.6</b> Practice 1<span></span></a></li>
<li class="chapter" data-level="10.6.7" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#practice-2-3"><i class="fa fa-check"></i><b>10.6.7</b> Practice 2<span></span></a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#exercise-making-predictions-from-regression-models."><i class="fa fa-check"></i><b>10.7</b> Exercise: Making Predictions from Regression Models.<span></span></a>
<ul>
<li class="chapter" data-level="10.7.1" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#case-study-7"><i class="fa fa-check"></i><b>10.7.1</b> Case Study<span></span></a></li>
<li class="chapter" data-level="10.7.2" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#creating-and-testing-our-model"><i class="fa fa-check"></i><b>10.7.2</b> Creating and Testing our Model<span></span></a></li>
<li class="chapter" data-level="10.7.3" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#visualizing-the-regression-model"><i class="fa fa-check"></i><b>10.7.3</b> Visualizing the Regression Model<span></span></a></li>
<li class="chapter" data-level="10.7.4" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#making-predictions-with-the-regression-model"><i class="fa fa-check"></i><b>10.7.4</b> Making Predictions with the Regression Model<span></span></a></li>
<li class="chapter" data-level="10.7.5" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#practice-1-4"><i class="fa fa-check"></i><b>10.7.5</b> Practice 1<span></span></a></li>
<li class="chapter" data-level="10.7.6" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#practice-2-4"><i class="fa fa-check"></i><b>10.7.6</b> Practice 2<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="nonlinear-relationships-and-multiple-linear-regression.html"><a href="nonlinear-relationships-and-multiple-linear-regression.html"><i class="fa fa-check"></i><b>11</b> Nonlinear Relationships and Multiple Linear Regression<span></span></a>
<ul>
<li class="chapter" data-level="11.1" data-path="nonlinear-relationships-and-multiple-linear-regression.html"><a href="nonlinear-relationships-and-multiple-linear-regression.html#multiplie-linear-regression"><i class="fa fa-check"></i><b>11.1</b> Multiplie Linear Regression<span></span></a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="nonlinear-relationships-and-multiple-linear-regression.html"><a href="nonlinear-relationships-and-multiple-linear-regression.html#case-study-modelling-yield-by-county"><i class="fa fa-check"></i><b>11.1.1</b> Case Study: Modelling Yield by County<span></span></a></li>
<li class="chapter" data-level="11.1.2" data-path="nonlinear-relationships-and-multiple-linear-regression.html"><a href="nonlinear-relationships-and-multiple-linear-regression.html#beware-of-bloated-models"><i class="fa fa-check"></i><b>11.1.2</b> Beware of Bloated Models<span></span></a></li>
<li class="chapter" data-level="11.1.3" data-path="nonlinear-relationships-and-multiple-linear-regression.html"><a href="nonlinear-relationships-and-multiple-linear-regression.html#methods-for-avoiding-bloated-models"><i class="fa fa-check"></i><b>11.1.3</b> Methods for Avoiding Bloated Models<span></span></a></li>
<li class="chapter" data-level="11.1.4" data-path="nonlinear-relationships-and-multiple-linear-regression.html"><a href="nonlinear-relationships-and-multiple-linear-regression.html#tunning-and-comparing-models"><i class="fa fa-check"></i><b>11.1.4</b> Tunning and Comparing Models<span></span></a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="nonlinear-relationships-and-multiple-linear-regression.html"><a href="nonlinear-relationships-and-multiple-linear-regression.html#nonlinear-relationships"><i class="fa fa-check"></i><b>11.2</b> Nonlinear Relationships<span></span></a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="nonlinear-relationships-and-multiple-linear-regression.html"><a href="nonlinear-relationships-and-multiple-linear-regression.html#fitting-nonlinear-responses-with-linear-regression"><i class="fa fa-check"></i><b>11.2.1</b> Fitting Nonlinear Responses with Linear Regression<span></span></a></li>
<li class="chapter" data-level="11.2.2" data-path="nonlinear-relationships-and-multiple-linear-regression.html"><a href="nonlinear-relationships-and-multiple-linear-regression.html#fitting-nonlinear-responses-with-nonlinear-regression"><i class="fa fa-check"></i><b>11.2.2</b> Fitting Nonlinear Responses with Nonlinear Regression<span></span></a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="nonlinear-relationships-and-multiple-linear-regression.html"><a href="nonlinear-relationships-and-multiple-linear-regression.html#summary-1"><i class="fa fa-check"></i><b>11.3</b> Summary<span></span></a></li>
<li class="chapter" data-level="11.4" data-path="nonlinear-relationships-and-multiple-linear-regression.html"><a href="nonlinear-relationships-and-multiple-linear-regression.html#exercise-multiple-linear-regression"><i class="fa fa-check"></i><b>11.4</b> Exercise: Multiple Linear Regression<span></span></a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="nonlinear-relationships-and-multiple-linear-regression.html"><a href="nonlinear-relationships-and-multiple-linear-regression.html#case-study-country-corn-yields"><i class="fa fa-check"></i><b>11.4.1</b> Case Study: Country Corn Yields<span></span></a></li>
<li class="chapter" data-level="11.4.2" data-path="nonlinear-relationships-and-multiple-linear-regression.html"><a href="nonlinear-relationships-and-multiple-linear-regression.html#fitting-the-model"><i class="fa fa-check"></i><b>11.4.2</b> Fitting the Model<span></span></a></li>
<li class="chapter" data-level="11.4.3" data-path="nonlinear-relationships-and-multiple-linear-regression.html"><a href="nonlinear-relationships-and-multiple-linear-regression.html#inspecting-the-model"><i class="fa fa-check"></i><b>11.4.3</b> Inspecting the Model<span></span></a></li>
<li class="chapter" data-level="11.4.4" data-path="nonlinear-relationships-and-multiple-linear-regression.html"><a href="nonlinear-relationships-and-multiple-linear-regression.html#practice-thompson-corn-data"><i class="fa fa-check"></i><b>11.4.4</b> Practice: Thompson Corn Data<span></span></a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="nonlinear-relationships-and-multiple-linear-regression.html"><a href="nonlinear-relationships-and-multiple-linear-regression.html#exercise-avoiding-bloated-models"><i class="fa fa-check"></i><b>11.5</b> Exercise: Avoiding Bloated Models<span></span></a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="nonlinear-relationships-and-multiple-linear-regression.html"><a href="nonlinear-relationships-and-multiple-linear-regression.html#case-study-8"><i class="fa fa-check"></i><b>11.5.1</b> Case Study<span></span></a></li>
<li class="chapter" data-level="11.5.2" data-path="nonlinear-relationships-and-multiple-linear-regression.html"><a href="nonlinear-relationships-and-multiple-linear-regression.html#covariance-matrix"><i class="fa fa-check"></i><b>11.5.2</b> Covariance Matrix<span></span></a></li>
<li class="chapter" data-level="11.5.3" data-path="nonlinear-relationships-and-multiple-linear-regression.html"><a href="nonlinear-relationships-and-multiple-linear-regression.html#partial-correlation-1"><i class="fa fa-check"></i><b>11.5.3</b> Partial Correlation<span></span></a></li>
<li class="chapter" data-level="11.5.4" data-path="nonlinear-relationships-and-multiple-linear-regression.html"><a href="nonlinear-relationships-and-multiple-linear-regression.html#cross-validation-1"><i class="fa fa-check"></i><b>11.5.4</b> Cross-Validation<span></span></a></li>
<li class="chapter" data-level="11.5.5" data-path="nonlinear-relationships-and-multiple-linear-regression.html"><a href="nonlinear-relationships-and-multiple-linear-regression.html#practice-thompson-corn-data-1"><i class="fa fa-check"></i><b>11.5.5</b> Practice: Thompson Corn Data<span></span></a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="nonlinear-relationships-and-multiple-linear-regression.html"><a href="nonlinear-relationships-and-multiple-linear-regression.html#exercise-tuning-the-model"><i class="fa fa-check"></i><b>11.6</b> Exercise: Tuning the Model<span></span></a>
<ul>
<li class="chapter" data-level="11.6.1" data-path="nonlinear-relationships-and-multiple-linear-regression.html"><a href="nonlinear-relationships-and-multiple-linear-regression.html#case-study-9"><i class="fa fa-check"></i><b>11.6.1</b> Case Study<span></span></a></li>
<li class="chapter" data-level="11.6.2" data-path="nonlinear-relationships-and-multiple-linear-regression.html"><a href="nonlinear-relationships-and-multiple-linear-regression.html#tuning-the-model"><i class="fa fa-check"></i><b>11.6.2</b> Tuning the Model<span></span></a></li>
<li class="chapter" data-level="11.6.3" data-path="nonlinear-relationships-and-multiple-linear-regression.html"><a href="nonlinear-relationships-and-multiple-linear-regression.html#practice-5"><i class="fa fa-check"></i><b>11.6.3</b> Practice<span></span></a></li>
<li class="chapter" data-level="11.6.4" data-path="nonlinear-relationships-and-multiple-linear-regression.html"><a href="nonlinear-relationships-and-multiple-linear-regression.html#practice-6"><i class="fa fa-check"></i><b>11.6.4</b> Practice<span></span></a></li>
</ul></li>
<li class="chapter" data-level="11.7" data-path="nonlinear-relationships-and-multiple-linear-regression.html"><a href="nonlinear-relationships-and-multiple-linear-regression.html#exercise-nonlinear-regression"><i class="fa fa-check"></i><b>11.7</b> Exercise: Nonlinear Regression<span></span></a>
<ul>
<li class="chapter" data-level="11.7.1" data-path="nonlinear-relationships-and-multiple-linear-regression.html"><a href="nonlinear-relationships-and-multiple-linear-regression.html#case-study-1-monomolecular-data"><i class="fa fa-check"></i><b>11.7.1</b> Case Study 1: Monomolecular Data<span></span></a></li>
<li class="chapter" data-level="11.7.2" data-path="nonlinear-relationships-and-multiple-linear-regression.html"><a href="nonlinear-relationships-and-multiple-linear-regression.html#case-study-2-logistic-data"><i class="fa fa-check"></i><b>11.7.2</b> Case Study 2: Logistic Data<span></span></a></li>
<li class="chapter" data-level="11.7.3" data-path="nonlinear-relationships-and-multiple-linear-regression.html"><a href="nonlinear-relationships-and-multiple-linear-regression.html#practice-1-5"><i class="fa fa-check"></i><b>11.7.3</b> Practice 1<span></span></a></li>
<li class="chapter" data-level="11.7.4" data-path="nonlinear-relationships-and-multiple-linear-regression.html"><a href="nonlinear-relationships-and-multiple-linear-regression.html#practice-2-5"><i class="fa fa-check"></i><b>11.7.4</b> Practice 2<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="spatial-statistics.html"><a href="spatial-statistics.html"><i class="fa fa-check"></i><b>12</b> Spatial Statistics<span></span></a>
<ul>
<li class="chapter" data-level="12.1" data-path="spatial-statistics.html"><a href="spatial-statistics.html#projection-general"><i class="fa fa-check"></i><b>12.1</b> Projection (General)<span></span></a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="spatial-statistics.html"><a href="spatial-statistics.html#wgs-84-epsg-4236"><i class="fa fa-check"></i><b>12.1.1</b> WGS 84 (EPSG: 4236)<span></span></a></li>
<li class="chapter" data-level="12.1.2" data-path="spatial-statistics.html"><a href="spatial-statistics.html#mercator-epsg-3857"><i class="fa fa-check"></i><b>12.1.2</b> Mercator (EPSG: 3857)<span></span></a></li>
<li class="chapter" data-level="12.1.3" data-path="spatial-statistics.html"><a href="spatial-statistics.html#us-national-atlas-equal-area-epsg-2163"><i class="fa fa-check"></i><b>12.1.3</b> US National Atlas Equal Area (EPSG: 2163)<span></span></a></li>
<li class="chapter" data-level="12.1.4" data-path="spatial-statistics.html"><a href="spatial-statistics.html#utm-zone-11n-epsg-2955"><i class="fa fa-check"></i><b>12.1.4</b> UTM Zone 11N (EPSG: 2955)<span></span></a></li>
<li class="chapter" data-level="12.1.5" data-path="spatial-statistics.html"><a href="spatial-statistics.html#projection-summary"><i class="fa fa-check"></i><b>12.1.5</b> Projection Summary<span></span></a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="spatial-statistics.html"><a href="spatial-statistics.html#shape-files"><i class="fa fa-check"></i><b>12.2</b> Shape Files<span></span></a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="spatial-statistics.html"><a href="spatial-statistics.html#case-study-soybean-yield-in-iowa"><i class="fa fa-check"></i><b>12.2.1</b> Case Study: Soybean Yield in Iowa<span></span></a></li>
<li class="chapter" data-level="12.2.2" data-path="spatial-statistics.html"><a href="spatial-statistics.html#ssurgo"><i class="fa fa-check"></i><b>12.2.2</b> SSURGO<span></span></a></li>
<li class="chapter" data-level="12.2.3" data-path="spatial-statistics.html"><a href="spatial-statistics.html#operations-with-shapes"><i class="fa fa-check"></i><b>12.2.3</b> Operations with Shapes<span></span></a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="spatial-statistics.html"><a href="spatial-statistics.html#rasters"><i class="fa fa-check"></i><b>12.3</b> Rasters<span></span></a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="spatial-statistics.html"><a href="spatial-statistics.html#interpolation"><i class="fa fa-check"></i><b>12.3.1</b> Interpolation<span></span></a></li>
<li class="chapter" data-level="12.3.2" data-path="spatial-statistics.html"><a href="spatial-statistics.html#kriging"><i class="fa fa-check"></i><b>12.3.2</b> Kriging<span></span></a></li>
<li class="chapter" data-level="12.3.3" data-path="spatial-statistics.html"><a href="spatial-statistics.html#operations-on-kriged-data"><i class="fa fa-check"></i><b>12.3.3</b> Operations on Kriged Data<span></span></a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="spatial-statistics.html"><a href="spatial-statistics.html#exercise-shape-files"><i class="fa fa-check"></i><b>12.4</b> Exercise: Shape Files<span></span></a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="spatial-statistics.html"><a href="spatial-statistics.html#case-study-10"><i class="fa fa-check"></i><b>12.4.1</b> Case Study<span></span></a></li>
<li class="chapter" data-level="12.4.2" data-path="spatial-statistics.html"><a href="spatial-statistics.html#practice-7"><i class="fa fa-check"></i><b>12.4.2</b> Practice<span></span></a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="spatial-statistics.html"><a href="spatial-statistics.html#exercise-ssurgo"><i class="fa fa-check"></i><b>12.5</b> Exercise: SSURGO<span></span></a></li>
<li class="chapter" data-level="12.6" data-path="spatial-statistics.html"><a href="spatial-statistics.html#exercise-rasters"><i class="fa fa-check"></i><b>12.6</b> Exercise: Rasters<span></span></a>
<ul>
<li class="chapter" data-level="12.6.1" data-path="spatial-statistics.html"><a href="spatial-statistics.html#case-study-soil-test-data"><i class="fa fa-check"></i><b>12.6.1</b> Case Study: Soil Test Data<span></span></a></li>
<li class="chapter" data-level="12.6.2" data-path="spatial-statistics.html"><a href="spatial-statistics.html#practice-1-6"><i class="fa fa-check"></i><b>12.6.2</b> Practice 1<span></span></a></li>
<li class="chapter" data-level="12.6.3" data-path="spatial-statistics.html"><a href="spatial-statistics.html#practice-2-6"><i class="fa fa-check"></i><b>12.6.3</b> Practice 2<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="machine-learning.html"><a href="machine-learning.html"><i class="fa fa-check"></i><b>13</b> Machine Learning<span></span></a>
<ul>
<li class="chapter" data-level="13.1" data-path="machine-learning.html"><a href="machine-learning.html#machine-learning-1"><i class="fa fa-check"></i><b>13.1</b> Machine Learning<span></span></a></li>
<li class="chapter" data-level="13.2" data-path="machine-learning.html"><a href="machine-learning.html#cluster-analyses"><i class="fa fa-check"></i><b>13.2</b> Cluster Analyses<span></span></a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="machine-learning.html"><a href="machine-learning.html#case-study-grouping-midwestern-environments"><i class="fa fa-check"></i><b>13.2.1</b> Case Study: Grouping Midwestern Environments<span></span></a></li>
<li class="chapter" data-level="13.2.2" data-path="machine-learning.html"><a href="machine-learning.html#scaling"><i class="fa fa-check"></i><b>13.2.2</b> Scaling<span></span></a></li>
<li class="chapter" data-level="13.2.3" data-path="machine-learning.html"><a href="machine-learning.html#clustering-animation"><i class="fa fa-check"></i><b>13.2.3</b> Clustering Animation<span></span></a></li>
<li class="chapter" data-level="13.2.4" data-path="machine-learning.html"><a href="machine-learning.html#county-cluster-analysis"><i class="fa fa-check"></i><b>13.2.4</b> County Cluster Analysis<span></span></a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="machine-learning.html"><a href="machine-learning.html#k-nearest-neighbors"><i class="fa fa-check"></i><b>13.3</b> k-Nearest-Neighbors<span></span></a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="machine-learning.html"><a href="machine-learning.html#case-study-guessing-county-yields-based-on-environmental-similarity"><i class="fa fa-check"></i><b>13.3.1</b> Case Study: Guessing County Yields based on Environmental Similarity<span></span></a></li>
<li class="chapter" data-level="13.3.2" data-path="machine-learning.html"><a href="machine-learning.html#scaling-1"><i class="fa fa-check"></i><b>13.3.2</b> Scaling<span></span></a></li>
<li class="chapter" data-level="13.3.3" data-path="machine-learning.html"><a href="machine-learning.html#k-nearest-neighbor-animation"><i class="fa fa-check"></i><b>13.3.3</b> k-Nearest-Neighbor Animation<span></span></a></li>
<li class="chapter" data-level="13.3.4" data-path="machine-learning.html"><a href="machine-learning.html#choosing-k"><i class="fa fa-check"></i><b>13.3.4</b> Choosing <span class="math inline">\(k\)</span><span></span></a></li>
<li class="chapter" data-level="13.3.5" data-path="machine-learning.html"><a href="machine-learning.html#model-cross-validation"><i class="fa fa-check"></i><b>13.3.5</b> Model Cross-Validation<span></span></a></li>
<li class="chapter" data-level="13.3.6" data-path="machine-learning.html"><a href="machine-learning.html#yield-prediction-with-nearest-neighbor-analysis"><i class="fa fa-check"></i><b>13.3.6</b> Yield Prediction with Nearest Neighbor Analysis<span></span></a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="machine-learning.html"><a href="machine-learning.html#classification-trees"><i class="fa fa-check"></i><b>13.4</b> Classification Trees<span></span></a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="machine-learning.html"><a href="machine-learning.html#features"><i class="fa fa-check"></i><b>13.4.1</b> Features<span></span></a></li>
<li class="chapter" data-level="13.4.2" data-path="machine-learning.html"><a href="machine-learning.html#quantitative-categorical-data"><i class="fa fa-check"></i><b>13.4.2</b> Quantitative (Categorical) Data<span></span></a></li>
<li class="chapter" data-level="13.4.3" data-path="machine-learning.html"><a href="machine-learning.html#quanatitiative-continuous-data"><i class="fa fa-check"></i><b>13.4.3</b> Quanatitiative (Continuous) Data<span></span></a></li>
<li class="chapter" data-level="13.4.4" data-path="machine-learning.html"><a href="machine-learning.html#overfitting-1"><i class="fa fa-check"></i><b>13.4.4</b> Overfitting<span></span></a></li>
<li class="chapter" data-level="13.4.5" data-path="machine-learning.html"><a href="machine-learning.html#cross-validation-2"><i class="fa fa-check"></i><b>13.4.5</b> Cross Validation<span></span></a></li>
<li class="chapter" data-level="13.4.6" data-path="machine-learning.html"><a href="machine-learning.html#random-forest"><i class="fa fa-check"></i><b>13.4.6</b> Random Forest<span></span></a></li>
<li class="chapter" data-level="13.4.7" data-path="machine-learning.html"><a href="machine-learning.html#feature-importance"><i class="fa fa-check"></i><b>13.4.7</b> Feature Importance<span></span></a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="machine-learning.html"><a href="machine-learning.html#summary-2"><i class="fa fa-check"></i><b>13.5</b> Summary<span></span></a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="putting-it-all-together.html"><a href="putting-it-all-together.html"><i class="fa fa-check"></i><b>14</b> Putting it all Together<span></span></a>
<ul>
<li class="chapter" data-level="14.1" data-path="putting-it-all-together.html"><a href="putting-it-all-together.html#scenario-1-yield-map-population-summary-and-z-distribution"><i class="fa fa-check"></i><b>14.1</b> Scenario 1: Yield Map (Population Summary and Z-Distribution)<span></span></a></li>
<li class="chapter" data-level="14.2" data-path="putting-it-all-together.html"><a href="putting-it-all-together.html#scenario-2-yield-estimate-sampling-t-distribution"><i class="fa fa-check"></i><b>14.2</b> Scenario 2: Yield Estimate (Sampling t-Distribution)<span></span></a></li>
<li class="chapter" data-level="14.3" data-path="putting-it-all-together.html"><a href="putting-it-all-together.html#scenario-3-side-by-side-t-test"><i class="fa fa-check"></i><b>14.3</b> Scenario 3: Side-By-Side (t-Test)<span></span></a></li>
<li class="chapter" data-level="14.4" data-path="putting-it-all-together.html"><a href="putting-it-all-together.html#scenario-4-fungicide-trial-anova-crd-or-rcbd"><i class="fa fa-check"></i><b>14.4</b> Scenario 4: Fungicide Trial (ANOVA CRD or RCBD)<span></span></a></li>
<li class="chapter" data-level="14.5" data-path="putting-it-all-together.html"><a href="putting-it-all-together.html#scenario-5-hybrid-response-to-fungicide-trial-anova-factorial-or-split-plot"><i class="fa fa-check"></i><b>14.5</b> Scenario 5: Hybrid Response to Fungicide Trial (ANOVA Factorial or Split Plot)<span></span></a></li>
<li class="chapter" data-level="14.6" data-path="putting-it-all-together.html"><a href="putting-it-all-together.html#scenario-6-foliar-rate-response-trial-linear-or-non-linear-regression"><i class="fa fa-check"></i><b>14.6</b> Scenario 6: Foliar Rate-Response Trial (Linear or Non-Linear Regression)<span></span></a></li>
<li class="chapter" data-level="14.7" data-path="putting-it-all-together.html"><a href="putting-it-all-together.html#scenario-7-application-map-shapefiles-and-rasters"><i class="fa fa-check"></i><b>14.7</b> Scenario 7: Application Map (Shapefiles and Rasters)<span></span></a></li>
<li class="chapter" data-level="14.8" data-path="putting-it-all-together.html"><a href="putting-it-all-together.html#scenario-8-yield-prediction-multiple-linear-regression-and-other-predictive-models"><i class="fa fa-check"></i><b>14.8</b> Scenario 8: Yield Prediction (Multiple Linear Regression and other Predictive Models)<span></span></a></li>
<li class="chapter" data-level="14.9" data-path="putting-it-all-together.html"><a href="putting-it-all-together.html#summary-3"><i class="fa fa-check"></i><b>14.9</b> Summary<span></span></a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Science for Agricultural Professionals</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="putting-it-all-together" class="section level1 hasAnchor" number="14">
<h1><span class="header-section-number">Chapter 14</span> Putting it all Together<a href="putting-it-all-together.html#putting-it-all-together" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>If I have done my job properly, your head is swimming with the different possibilities for collecting and analyzing data. Now it is time for us to back up and revisit the tests we have learned and understand how to choose a design or test for a given situation. Furthermore, it is important we round out this semester by understanding how to report results to others. This includes what to report and how to present it.</p>
<p>In contrast with more general statistics courses, I have tried to build this course around a series of trials which you are are likely to conduct or from which you will use data. These range from a simple yield map through more complex factorial trials through nonlinear data and application maps. In this unit, we will review those scenarios and the tools we used to hack them.</p>
<div id="scenario-1-yield-map-population-summary-and-z-distribution" class="section level2 hasAnchor" number="14.1">
<h2><span class="header-section-number">14.1</span> Scenario 1: Yield Map (Population Summary and Z-Distribution)<a href="putting-it-all-together.html#scenario-1-yield-map-population-summary-and-z-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><em>You are presented with a yield map and wish to summarize its yields so you can compare it with other fields. Since you have measured the entire field with you yield monitor, you are summarizing a population and therefore will calculate the population mean and standard deviation.</em></p>
<p>We started out the semester with a yield map, like this one:</p>
<div class="sourceCode" id="cb1029"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1029-1"><a href="putting-it-all-together.html#cb1029-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1029-2"><a href="putting-it-all-together.html#cb1029-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb1029-3"><a href="putting-it-all-together.html#cb1029-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaflet)</span>
<span id="cb1029-4"><a href="putting-it-all-together.html#cb1029-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(grDevices)</span>
<span id="cb1029-5"><a href="putting-it-all-together.html#cb1029-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(htmlwidgets)</span>
<span id="cb1029-6"><a href="putting-it-all-together.html#cb1029-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(webshot2)</span>
<span id="cb1029-7"><a href="putting-it-all-together.html#cb1029-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1029-8"><a href="putting-it-all-together.html#cb1029-8" aria-hidden="true" tabindex="-1"></a>logan <span class="ot">=</span> <span class="fu">st_read</span>(<span class="st">&quot;data-unit-14/Young North Corn 20.shp&quot;</span>, <span class="at">quiet=</span><span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1029-9"><a href="putting-it-all-together.html#cb1029-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Yld_Vol_Dr <span class="sc">&gt;=</span><span class="dv">50</span> <span class="sc">&amp;</span> Yld_Vol_Dr <span class="sc">&lt;=</span><span class="dv">350</span>)</span>
<span id="cb1029-10"><a href="putting-it-all-together.html#cb1029-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1029-11"><a href="putting-it-all-together.html#cb1029-11" aria-hidden="true" tabindex="-1"></a>pal <span class="ot">=</span> <span class="fu">colorBin</span>(<span class="st">&quot;RdYlGn&quot;</span>, logan<span class="sc">$</span>Yld_Vol_Dr) </span>
<span id="cb1029-12"><a href="putting-it-all-together.html#cb1029-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1029-13"><a href="putting-it-all-together.html#cb1029-13" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> logan <span class="sc">%&gt;%</span></span>
<span id="cb1029-14"><a href="putting-it-all-together.html#cb1029-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">leaflet</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1029-15"><a href="putting-it-all-together.html#cb1029-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addTiles</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1029-16"><a href="putting-it-all-together.html#cb1029-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addCircleMarkers</span>(</span>
<span id="cb1029-17"><a href="putting-it-all-together.html#cb1029-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">radius =</span> <span class="dv">1</span>,</span>
<span id="cb1029-18"><a href="putting-it-all-together.html#cb1029-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">fillColor =</span> <span class="sc">~</span><span class="fu">pal</span>(Yld_Vol_Dr),</span>
<span id="cb1029-19"><a href="putting-it-all-together.html#cb1029-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">weight =</span> <span class="dv">0</span>,</span>
<span id="cb1029-20"><a href="putting-it-all-together.html#cb1029-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">fillOpacity =</span> <span class="dv">1</span>,</span>
<span id="cb1029-21"><a href="putting-it-all-together.html#cb1029-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">popup =</span> <span class="fu">as.character</span>(logan<span class="sc">$</span>Yld_Vol_Dr)</span>
<span id="cb1029-22"><a href="putting-it-all-together.html#cb1029-22" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1029-23"><a href="putting-it-all-together.html#cb1029-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1029-24"><a href="putting-it-all-together.html#cb1029-24" aria-hidden="true" tabindex="-1"></a><span class="co">#above code won&#39;t knit -- created static image for markdown</span></span>
<span id="cb1029-25"><a href="putting-it-all-together.html#cb1029-25" aria-hidden="true" tabindex="-1"></a><span class="fu">saveWidget</span>(m, <span class="st">&quot;temp.html&quot;</span>, <span class="at">selfcontained =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1029-26"><a href="putting-it-all-together.html#cb1029-26" aria-hidden="true" tabindex="-1"></a><span class="fu">webshot</span>(<span class="st">&quot;temp.html&quot;</span>, <span class="at">cliprect =</span> <span class="st">&quot;viewport&quot;</span>)</span></code></pre></div>
<p><img src="14-Putting-It-All_together_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<p>In the map above, the higher-yielding areas are colored green, while the lower-yielding areas are orange to red. How would we summarise the yields above for others?</p>
<p>To start with, let’s describe the center of the population. Should we use the mean or median? Either is appropriate if the data are normally distributed; if the data are skewed, the median will be a better measure of center. We can check the distribution using a histogram:</p>
<div class="sourceCode" id="cb1030"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1030-1"><a href="putting-it-all-together.html#cb1030-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(logan<span class="sc">$</span>Yld_Vol_Dr)</span></code></pre></div>
<p><img src="14-Putting-It-All_together_files/figure-html/unnamed-chunk-3-1.png" width="672" />
We inspect the data to see if it fits a normal distribution (“bell”) curve. This histogram is admittedly ugly, but is roughly symmetrical. We can also quickly inspect our distribution using the summary command on our yield variable.</p>
<div class="sourceCode" id="cb1031"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1031-1"><a href="putting-it-all-together.html#cb1031-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(logan<span class="sc">$</span>Yld_Vol_Dr)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##    50.1   169.2   216.6   211.1   252.3   348.2</code></pre>
<p>The median and mean are similar, so it would be acceptable to use either to describe the population center. Note the median is a little larger than the mean, so our data is skewed slightly to the right.</p>
<p>How would we describe the spread? That’s right: we would use the standard deviation:</p>
<div class="sourceCode" id="cb1033"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1033-1"><a href="putting-it-all-together.html#cb1033-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(logan<span class="sc">$</span>Yld_Vol_Dr)</span></code></pre></div>
<pre><code>## [1] 54.10512</code></pre>
<p>Our standard deviation is about 54 bushels. What is the significance of this? We would expect 95% of the individuals (the yield measures) in this population to be within 1.96 standard deviations, or $1.96 = 106.0 $, of the mean. Rounding our mean to 211, we would expect any value less than <span class="math inline">\(211 - 106 = 105\)</span> or greater than <span class="math inline">\(211 + 105 = 316\)</span> to occur rarely in our population.</p>
</div>
<div id="scenario-2-yield-estimate-sampling-t-distribution" class="section level2 hasAnchor" number="14.2">
<h2><span class="header-section-number">14.2</span> Scenario 2: Yield Estimate (Sampling t-Distribution)<a href="putting-it-all-together.html#scenario-2-yield-estimate-sampling-t-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><em>We are on a “Pro-Growers” tour of the Corn Belt or we are estimating yield on our own farm in anticipation of harvest or marketing grain.</em></p>
<p>Let’s take our field above and sample 20 ears from it. After counting rows around the ear and kernels per row, we arrive at the following 20 estimates.</p>
<pre><code>##  [1] 256 136 244 154 191 241 292 225 183 277 249 207 290 203 213 226 266 275 151
## [20] 181</code></pre>
<p>The mean of our samples is 223 bushels per acre. We know this is probably not the actual mean yield, but how can we define a range of values that is likely to include the true mean for this field?</p>
<p>We can calculate a 95% confidence interval for this field. That confidence interval defines a fixed distance above and below our sample mean. Were we to repeat our sampling 100 times, in about 95 of our samples the population mean would be within our confidence interval.</p>
<p>Remember, our confidence interval is calculated as:</p>
<p><span class="math display">\[ CI = \bar{x} + t_{\alpha, df}\times SE\]</span></p>
<p>Where <span class="math inline">\(\bar{x}\)</span> is the sample mean, <span class="math inline">\(t\)</span> is the t-value, based on our desired level of confidence and the degrees of freedom, and <span class="math inline">\(SE\)</span> is the standard error of the mean. In this case, we desire 95% confidence and have 19 degrees of freedom (since we have 20 samples). The t-value to use in our calculation is therefore:</p>
<div class="sourceCode" id="cb1036"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1036-1"><a href="putting-it-all-together.html#cb1036-1" aria-hidden="true" tabindex="-1"></a>t_value <span class="ot">=</span> <span class="fu">qt</span>(<span class="fl">0.975</span>, <span class="dv">20</span>)</span>
<span id="cb1036-2"><a href="putting-it-all-together.html#cb1036-2" aria-hidden="true" tabindex="-1"></a>t_value</span></code></pre></div>
<pre><code>## [1] 2.085963</code></pre>
<p>Our standard error is equal to the standard deviation of our samples.</p>
<div class="sourceCode" id="cb1038"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1038-1"><a href="putting-it-all-together.html#cb1038-1" aria-hidden="true" tabindex="-1"></a>yield_sd <span class="ot">=</span> <span class="fu">sd</span>(yield_sample)</span>
<span id="cb1038-2"><a href="putting-it-all-together.html#cb1038-2" aria-hidden="true" tabindex="-1"></a>yield_sd</span></code></pre></div>
<pre><code>## [1] 46.97144</code></pre>
<p>Our standard error of the mean is our sample standard deviation, divided by the square root of the number of observations (20 ears) in the sample:</p>
<div class="sourceCode" id="cb1040"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1040-1"><a href="putting-it-all-together.html#cb1040-1" aria-hidden="true" tabindex="-1"></a>SE <span class="ot">=</span> yield_sd<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">20</span>)</span>
<span id="cb1040-2"><a href="putting-it-all-together.html#cb1040-2" aria-hidden="true" tabindex="-1"></a>SE</span></code></pre></div>
<pre><code>## [1] 10.50313</code></pre>
<p>Our confidence interval has a lower limit of <span class="math inline">\(223 - 2.09*10.5 = 201.1\)</span> and an upper limit of <span class="math inline">\(223 + 2.09*10.5 = 244.9\)</span>. We would present this confidence interval as:</p>
<p><span class="math display">\[ (201.1,244.9) \]</span></p>
<p>We know the combine map aboe the true population mean was 211.1, which is included in our confidence interval.</p>
</div>
<div id="scenario-3-side-by-side-t-test" class="section level2 hasAnchor" number="14.3">
<h2><span class="header-section-number">14.3</span> Scenario 3: Side-By-Side (t-Test)<a href="putting-it-all-together.html#scenario-3-side-by-side-t-test" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><em>You are a sales agronomist and want to demonstrate a new product to your customer. You arrange to conduct a side-by-side trial on their farm.</em></p>
<p>Knowing every field has soil variations, you divide a field into 8 pairs of strips. Each strip in a pair is treated either with the farmer’s current system (the control) or the farmer’s system <em>plus</em> the new product. You create the following paired plot layout.</p>
<p><img src="14-Putting-It-All_together_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>We observe the following values in our trial:</p>
<table>
<thead>
<tr>
<th style="text-align:right;">
block
</th>
<th style="text-align:left;">
treatment
</th>
<th style="text-align:right;">
yield
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
control
</td>
<td style="text-align:right;">
172.2
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
treatment
</td>
<td style="text-align:right;">
170.9
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
treatment
</td>
<td style="text-align:right;">
168.7
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
control
</td>
<td style="text-align:right;">
169.1
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
treatment
</td>
<td style="text-align:right;">
178.3
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
control
</td>
<td style="text-align:right;">
144.8
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
control
</td>
<td style="text-align:right;">
178.5
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
treatment
</td>
<td style="text-align:right;">
183.5
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
control
</td>
<td style="text-align:right;">
177.6
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
treatment
</td>
<td style="text-align:right;">
193.6
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:left;">
treatment
</td>
<td style="text-align:right;">
186.8
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:left;">
control
</td>
<td style="text-align:right;">
176.5
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
control
</td>
<td style="text-align:right;">
172.7
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
treatment
</td>
<td style="text-align:right;">
196.0
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:left;">
control
</td>
<td style="text-align:right;">
188.9
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:left;">
treatment
</td>
<td style="text-align:right;">
183.7
</td>
</tr>
</tbody>
</table>
<p>We run a t-test, as we learned in Units 4 and 5, which calculates the probability the difference between the control and treatment is equal to zero. Because we, as sales persons, are only interested in whether our treatment produces greater yield, we run a one-sided test. Our null hypothesis is therefore that the treatment produces yield equal to or less than the control. Our alternative hypothesis (the one we hope to confirm) is that the treatment yields more than the control.</p>
<div class="sourceCode" id="cb1042"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1042-1"><a href="putting-it-all-together.html#cb1042-1" aria-hidden="true" tabindex="-1"></a>t_test <span class="ot">=</span> <span class="fu">t.test</span>(yield <span class="sc">~</span> treatment, <span class="at">data=</span>yields, <span class="at">paired=</span><span class="cn">TRUE</span>, <span class="at">alternative=</span><span class="st">&quot;less&quot;</span>)</span>
<span id="cb1042-2"><a href="putting-it-all-together.html#cb1042-2" aria-hidden="true" tabindex="-1"></a>t_test</span></code></pre></div>
<pre><code>## 
##  Paired t-test
## 
## data:  yield by treatment
## t = -2.1424, df = 7, p-value = 0.03469
## alternative hypothesis: true difference in means is less than 0
## 95 percent confidence interval:
##       -Inf -1.174144
## sample estimates:
## mean of the differences 
##                  -10.15</code></pre>
<p>In the t-test above, we tested the difference when we subtracted the control yield from the treatment yield. We hoped this difference would be less than zero, which it would be if the treatment yield exceeded the control yield. We see the difference, -10.15, was indeed less than zero. Was it significant? Our p-value was 0.03, indicating a small probability that the true difference was actually zero or greater than zero.</p>
<p>We also see our confidence interval does not include zero or any positive values. We can therefore report to the grower that our treatment yielded more than the control.</p>
</div>
<div id="scenario-4-fungicide-trial-anova-crd-or-rcbd" class="section level2 hasAnchor" number="14.4">
<h2><span class="header-section-number">14.4</span> Scenario 4: Fungicide Trial (ANOVA CRD or RCBD)<a href="putting-it-all-together.html#scenario-4-fungicide-trial-anova-crd-or-rcbd" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><em>We want to compare three or more fungicides that differ in their qualities, as opposed to their quantity.</em></p>
<p>We design and conduct a randomized complete block design experiment in which four fungicides are compared:</p>
<table>
<thead>
<tr>
<th style="text-align:right;">
plot
</th>
<th style="text-align:left;">
block
</th>
<th style="text-align:left;">
fungicide
</th>
<th style="text-align:right;">
yield
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
101
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
Deadest
</td>
<td style="text-align:right;">
174.4
</td>
</tr>
<tr>
<td style="text-align:right;">
102
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
Dead
</td>
<td style="text-align:right;">
169.5
</td>
</tr>
<tr>
<td style="text-align:right;">
103
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
Dead Again
</td>
<td style="text-align:right;">
176.9
</td>
</tr>
<tr>
<td style="text-align:right;">
104
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
Deader
</td>
<td style="text-align:right;">
170.6
</td>
</tr>
<tr>
<td style="text-align:right;">
201
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
Dead Again
</td>
<td style="text-align:right;">
175.7
</td>
</tr>
<tr>
<td style="text-align:right;">
202
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
Deadest
</td>
<td style="text-align:right;">
175.5
</td>
</tr>
<tr>
<td style="text-align:right;">
203
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
Deader
</td>
<td style="text-align:right;">
171.9
</td>
</tr>
<tr>
<td style="text-align:right;">
204
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
Dead
</td>
<td style="text-align:right;">
170.9
</td>
</tr>
<tr>
<td style="text-align:right;">
301
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
Deader
</td>
<td style="text-align:right;">
172.5
</td>
</tr>
<tr>
<td style="text-align:right;">
302
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
Dead Again
</td>
<td style="text-align:right;">
178.2
</td>
</tr>
<tr>
<td style="text-align:right;">
303
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
Dead
</td>
<td style="text-align:right;">
170.9
</td>
</tr>
<tr>
<td style="text-align:right;">
304
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
Deadest
</td>
<td style="text-align:right;">
175.6
</td>
</tr>
<tr>
<td style="text-align:right;">
401
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
Deadest
</td>
<td style="text-align:right;">
176.7
</td>
</tr>
<tr>
<td style="text-align:right;">
402
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
Deader
</td>
<td style="text-align:right;">
174.1
</td>
</tr>
<tr>
<td style="text-align:right;">
403
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
Dead Again
</td>
<td style="text-align:right;">
177.8
</td>
</tr>
<tr>
<td style="text-align:right;">
404
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
Dead
</td>
<td style="text-align:right;">
170.7
</td>
</tr>
</tbody>
</table>
<p>We can begin our analysis of results by inspecting the distribution of observations within our treatment. We can take a quick look at our data with the boxplot we learned in Unit 9.</p>
<div class="sourceCode" id="cb1044"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1044-1"><a href="putting-it-all-together.html#cb1044-1" aria-hidden="true" tabindex="-1"></a>fungicide_final <span class="sc">%&gt;%</span></span>
<span id="cb1044-2"><a href="putting-it-all-together.html#cb1044-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>fungicide, <span class="at">y=</span>yield)) <span class="sc">+</span> </span>
<span id="cb1044-3"><a href="putting-it-all-together.html#cb1044-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_boxplot</span>(<span class="at">outlier.colour=</span><span class="st">&quot;black&quot;</span>, <span class="at">outlier.shape=</span><span class="dv">16</span>,</span>
<span id="cb1044-4"><a href="putting-it-all-together.html#cb1044-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">outlier.size=</span><span class="dv">2</span>, <span class="at">notch=</span><span class="cn">FALSE</span>, <span class="at">fill=</span><span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb1044-5"><a href="putting-it-all-together.html#cb1044-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb1044-6"><a href="putting-it-all-together.html#cb1044-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stat_summary</span>(<span class="at">fun=</span>mean, <span class="at">geom=</span><span class="st">&quot;point&quot;</span>, <span class="at">shape=</span><span class="dv">23</span>, <span class="at">size=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="14-Putting-It-All_together_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<p>Hmmmm, fungicide “Dead” has an outlier. Shoots. Let’s look more closely at our situation. First, back to our field notes. We check our plot notes – nothing appeared out of the ordinary about that plot. Second, we notice the “Dead” treatment has a tighter distribution than the other three treatments: our outlier would not be an outlier had it occurred in the distribution of Deader. Finally, we note the outlier differs from from the mean and median of “Dead” by only a few bushels – a deviation we consider to be reasonable given our knowledge of corn production. We conclude the outlier can be included in the dataset.</p>
<p>We will go ahead and run an Analysis of Variance on these data, as we learned in Unit 8. Our linear model is:</p>
<p><span class="math display">\[ Y_{ij}=\mu + B_i + T_j + BT_{ij}\]</span>
Where <span class="math inline">\(\mu\)</span> is the population mean, <span class="math inline">\(Y\)</span> is the yield of the <span class="math inline">\(j_{th}\)</span> treatment in the <span class="math inline">\(i_{th}\)</span> block, <span class="math inline">\(B\)</span> is the effect of the <span class="math inline">\(i_{th}\)</span> block, <span class="math inline">\(T\)</span> is the effect of the <span class="math inline">\(j_{th}\)</span> treatment, and <span class="math inline">\(BT_{ij}\)</span> is the interaction between block and treatment. This model forms the basis of our model statement to R:</p>
<div class="sourceCode" id="cb1045"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1045-1"><a href="putting-it-all-together.html#cb1045-1" aria-hidden="true" tabindex="-1"></a>fungicide_model <span class="ot">=</span> <span class="fu">aov</span>(yield <span class="sc">~</span> block <span class="sc">+</span> fungicide, <span class="at">data=</span>fungicide_final)</span>
<span id="cb1045-2"><a href="putting-it-all-together.html#cb1045-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fungicide_model)</span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## block        3   9.10    3.03   5.535   0.0197 *  
## fungicide    3 109.93   36.64  66.884 1.79e-06 ***
## Residuals    9   4.93    0.55                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>We see the effect of the fungicide treatment is highly significant, so we will separate the means using the LSD test we learned in Unit 8.</p>
<div class="sourceCode" id="cb1047"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1047-1"><a href="putting-it-all-together.html#cb1047-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(agricolae)</span>
<span id="cb1047-2"><a href="putting-it-all-together.html#cb1047-2" aria-hidden="true" tabindex="-1"></a>lsd <span class="ot">=</span> <span class="fu">LSD.test</span>(fungicide_model, <span class="st">&quot;fungicide&quot;</span>)</span>
<span id="cb1047-3"><a href="putting-it-all-together.html#cb1047-3" aria-hidden="true" tabindex="-1"></a>lsd</span></code></pre></div>
<pre><code>## $statistics
##     MSerror Df     Mean        CV  t.value      LSD
##   0.5478472  9 173.8688 0.4257045 2.262157 1.183961
## 
## $parameters
##         test p.ajusted    name.t ntr alpha
##   Fisher-LSD      none fungicide   4  0.05
## 
## $means
##              yield       std r      LCL      UCL   Min   Max     Q25    Q50
## Dead       170.500 0.6733003 4 169.6628 171.3372 169.5 170.9 170.400 170.80
## Dead Again 177.150 1.1090537 4 176.3128 177.9872 175.7 178.2 176.600 177.35
## Deader     172.275 1.4522970 4 171.4378 173.1122 170.6 174.1 171.575 172.20
## Deadest    175.550 0.9398581 4 174.7128 176.3872 174.4 176.7 175.225 175.55
##                Q75
## Dead       170.900
## Dead Again 177.900
## Deader     172.900
## Deadest    175.875
## 
## $comparison
## NULL
## 
## $groups
##              yield groups
## Dead Again 177.150      a
## Deadest    175.550      b
## Deader     172.275      c
## Dead       170.500      d
## 
## attr(,&quot;class&quot;)
## [1] &quot;group&quot;</code></pre>
<p>Each of the fungicides produced significantly different yields, with “Dead Again” the highest-yielding. We can plot these results in a bar-plot.</p>
<div class="sourceCode" id="cb1049"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1049-1"><a href="putting-it-all-together.html#cb1049-1" aria-hidden="true" tabindex="-1"></a>lsd_groups <span class="ot">=</span> lsd<span class="sc">$</span>groups <span class="sc">%&gt;%</span></span>
<span id="cb1049-2"><a href="putting-it-all-together.html#cb1049-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">&quot;fungicide&quot;</span>)</span>
<span id="cb1049-3"><a href="putting-it-all-together.html#cb1049-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1049-4"><a href="putting-it-all-together.html#cb1049-4" aria-hidden="true" tabindex="-1"></a>lsd_groups <span class="sc">%&gt;%</span></span>
<span id="cb1049-5"><a href="putting-it-all-together.html#cb1049-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>fungicide, <span class="at">y=</span>yield)) <span class="sc">+</span></span>
<span id="cb1049-6"><a href="putting-it-all-together.html#cb1049-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">fill=</span><span class="st">&quot;darkolivegreen&quot;</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<p><img src="14-Putting-It-All_together_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
</div>
<div id="scenario-5-hybrid-response-to-fungicide-trial-anova-factorial-or-split-plot" class="section level2 hasAnchor" number="14.5">
<h2><span class="header-section-number">14.5</span> Scenario 5: Hybrid Response to Fungicide Trial (ANOVA Factorial or Split Plot)<a href="putting-it-all-together.html#scenario-5-hybrid-response-to-fungicide-trial-anova-factorial-or-split-plot" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><em>We want to test two factors within the same trial: three levels of hybrid (Hybrids “A”, “B”, and “C”) and two levels of fungicide (“treated” and “untreated”).</em></p>
<p>The treatments are arranged in a factorial randomized complete block design, like we learned in Unit 7.</p>
<table>
<thead>
<tr>
<th style="text-align:right;">
plot
</th>
<th style="text-align:left;">
block
</th>
<th style="text-align:left;">
fungicide
</th>
<th style="text-align:left;">
hybrid
</th>
<th style="text-align:right;">
yield
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
101
</td>
<td style="text-align:left;">
R1
</td>
<td style="text-align:left;">
treated
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
199.1
</td>
</tr>
<tr>
<td style="text-align:right;">
102
</td>
<td style="text-align:left;">
R1
</td>
<td style="text-align:left;">
untreated
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
172.1
</td>
</tr>
<tr>
<td style="text-align:right;">
103
</td>
<td style="text-align:left;">
R1
</td>
<td style="text-align:left;">
untreated
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
187.4
</td>
</tr>
<tr>
<td style="text-align:right;">
104
</td>
<td style="text-align:left;">
R1
</td>
<td style="text-align:left;">
treated
</td>
<td style="text-align:left;">
C
</td>
<td style="text-align:right;">
204.1
</td>
</tr>
<tr>
<td style="text-align:right;">
105
</td>
<td style="text-align:left;">
R1
</td>
<td style="text-align:left;">
untreated
</td>
<td style="text-align:left;">
C
</td>
<td style="text-align:right;">
195.5
</td>
</tr>
<tr>
<td style="text-align:right;">
106
</td>
<td style="text-align:left;">
R1
</td>
<td style="text-align:left;">
treated
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
187.2
</td>
</tr>
<tr>
<td style="text-align:right;">
201
</td>
<td style="text-align:left;">
R2
</td>
<td style="text-align:left;">
treated
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
195.7
</td>
</tr>
<tr>
<td style="text-align:right;">
202
</td>
<td style="text-align:left;">
R2
</td>
<td style="text-align:left;">
untreated
</td>
<td style="text-align:left;">
C
</td>
<td style="text-align:right;">
200.3
</td>
</tr>
<tr>
<td style="text-align:right;">
203
</td>
<td style="text-align:left;">
R2
</td>
<td style="text-align:left;">
treated
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
200.3
</td>
</tr>
<tr>
<td style="text-align:right;">
204
</td>
<td style="text-align:left;">
R2
</td>
<td style="text-align:left;">
treated
</td>
<td style="text-align:left;">
C
</td>
<td style="text-align:right;">
216.5
</td>
</tr>
<tr>
<td style="text-align:right;">
205
</td>
<td style="text-align:left;">
R2
</td>
<td style="text-align:left;">
untreated
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
185.0
</td>
</tr>
<tr>
<td style="text-align:right;">
206
</td>
<td style="text-align:left;">
R2
</td>
<td style="text-align:left;">
untreated
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
188.4
</td>
</tr>
<tr>
<td style="text-align:right;">
301
</td>
<td style="text-align:left;">
R3
</td>
<td style="text-align:left;">
treated
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
209.4
</td>
</tr>
<tr>
<td style="text-align:right;">
302
</td>
<td style="text-align:left;">
R3
</td>
<td style="text-align:left;">
treated
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
198.2
</td>
</tr>
<tr>
<td style="text-align:right;">
303
</td>
<td style="text-align:left;">
R3
</td>
<td style="text-align:left;">
untreated
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
185.6
</td>
</tr>
<tr>
<td style="text-align:right;">
304
</td>
<td style="text-align:left;">
R3
</td>
<td style="text-align:left;">
untreated
</td>
<td style="text-align:left;">
C
</td>
<td style="text-align:right;">
203.6
</td>
</tr>
<tr>
<td style="text-align:right;">
305
</td>
<td style="text-align:left;">
R3
</td>
<td style="text-align:left;">
untreated
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
194.2
</td>
</tr>
<tr>
<td style="text-align:right;">
306
</td>
<td style="text-align:left;">
R3
</td>
<td style="text-align:left;">
treated
</td>
<td style="text-align:left;">
C
</td>
<td style="text-align:right;">
220.4
</td>
</tr>
<tr>
<td style="text-align:right;">
401
</td>
<td style="text-align:left;">
R4
</td>
<td style="text-align:left;">
untreated
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
198.7
</td>
</tr>
<tr>
<td style="text-align:right;">
402
</td>
<td style="text-align:left;">
R4
</td>
<td style="text-align:left;">
treated
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
214.4
</td>
</tr>
<tr>
<td style="text-align:right;">
403
</td>
<td style="text-align:left;">
R4
</td>
<td style="text-align:left;">
treated
</td>
<td style="text-align:left;">
C
</td>
<td style="text-align:right;">
219.2
</td>
</tr>
<tr>
<td style="text-align:right;">
404
</td>
<td style="text-align:left;">
R4
</td>
<td style="text-align:left;">
treated
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
194.8
</td>
</tr>
<tr>
<td style="text-align:right;">
405
</td>
<td style="text-align:left;">
R4
</td>
<td style="text-align:left;">
untreated
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
191.0
</td>
</tr>
<tr>
<td style="text-align:right;">
406
</td>
<td style="text-align:left;">
R4
</td>
<td style="text-align:left;">
untreated
</td>
<td style="text-align:left;">
C
</td>
<td style="text-align:right;">
199.6
</td>
</tr>
</tbody>
</table>
<p>Our linear additive model is:</p>
<p><span class="math display">\[ Y_{ijk} = \mu + B_i + F_j + H_k + FH_{jk} + BFH_{ijk} \]</span></p>
<p>where <span class="math inline">\(Y_{ijk}\)</span> is the yield in the <span class="math inline">\(ith\)</span> block with the <span class="math inline">\(jth\)</span> level of fungicide and the <span class="math inline">\(kth\)</span> level of hybrid, <span class="math inline">\(\mu\)</span> is the population mean, <span class="math inline">\(B_i\)</span> is the effect of the <span class="math inline">\(ith\)</span> block, <span class="math inline">\(F_j\)</span> is the effect of the <span class="math inline">\(jth\)</span> level of fungicide, <span class="math inline">\(H_k\)</span> is the effect of the <span class="math inline">\(kth\)</span> level of hybrid, <span class="math inline">\(FH_{jk}\)</span> is the interaction of the $jth level of fungicide and <span class="math inline">\(kth\)</span> level of hybrid, and <span class="math inline">\(BFH_{ijk}\)</span> is the interaction of block, fungicide, and hybrid.</p>
<p>This translates to the following model statement and analysis of variance:</p>
<div class="sourceCode" id="cb1050"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1050-1"><a href="putting-it-all-together.html#cb1050-1" aria-hidden="true" tabindex="-1"></a>fung_hyb_model <span class="ot">=</span> <span class="fu">aov</span>(yield <span class="sc">~</span> block <span class="sc">+</span> fungicide <span class="sc">+</span> hybrid <span class="sc">+</span> fungicide<span class="sc">*</span>hybrid, <span class="at">data =</span> fung_hyb_final)</span>
<span id="cb1050-2"><a href="putting-it-all-together.html#cb1050-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fung_hyb_model)</span></code></pre></div>
<pre><code>##                  Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## block             3  538.1   179.4   15.92 6.27e-05 ***
## fungicide         1 1038.9  1038.9   92.22 8.49e-08 ***
## hybrid            2 1403.4   701.7   62.29 5.43e-08 ***
## fungicide:hybrid  2   23.2    11.6    1.03    0.381    
## Residuals        15  169.0    11.3                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>The Analysis of Variance results above, show that the main effects – fungicide and hybrid – are both highly-significant, but the interaction between fungicide and hybrid is insignificant. The line plot below allows us to further examine that interaction.</p>
<div class="sourceCode" id="cb1052"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1052-1"><a href="putting-it-all-together.html#cb1052-1" aria-hidden="true" tabindex="-1"></a>fung_hyb <span class="sc">%&gt;%</span></span>
<span id="cb1052-2"><a href="putting-it-all-together.html#cb1052-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(fungicide, hybrid) <span class="sc">%&gt;%</span></span>
<span id="cb1052-3"><a href="putting-it-all-together.html#cb1052-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">yield =</span> <span class="fu">mean</span>(yield)) <span class="sc">%&gt;%</span></span>
<span id="cb1052-4"><a href="putting-it-all-together.html#cb1052-4" aria-hidden="true" tabindex="-1"></a>  ungroup <span class="sc">%&gt;%</span></span>
<span id="cb1052-5"><a href="putting-it-all-together.html#cb1052-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>hybrid, <span class="at">y=</span>yield, <span class="at">group=</span>fungicide)) <span class="sc">+</span></span>
<span id="cb1052-6"><a href="putting-it-all-together.html#cb1052-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span>fungicide)) <span class="sc">+</span></span>
<span id="cb1052-7"><a href="putting-it-all-together.html#cb1052-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color=</span>fungicide))</span></code></pre></div>
<p><img src="14-Putting-It-All_together_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<p>We can perform means separation on the data the same as we did for our analysis of variance in the previous example. Since fungicide only has two levels, its significance in the analysis of variance means the two levels (“treated” and “untreated”) are significant. To separate the hybrid levels, we can use the least siginficant difference test.</p>
<div class="sourceCode" id="cb1053"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1053-1"><a href="putting-it-all-together.html#cb1053-1" aria-hidden="true" tabindex="-1"></a>lsd_fung_hybrid <span class="ot">=</span> <span class="fu">LSD.test</span>(fung_hyb_model, <span class="st">&quot;hybrid&quot;</span>)</span>
<span id="cb1053-2"><a href="putting-it-all-together.html#cb1053-2" aria-hidden="true" tabindex="-1"></a>lsd_fung_hybrid</span></code></pre></div>
<pre><code>## $statistics
##    MSerror Df     Mean       CV t.value      LSD
##   11.26542 15 198.3625 1.692053 2.13145 3.576998
## 
## $parameters
##         test p.ajusted name.t ntr alpha
##   Fisher-LSD      none hybrid   3  0.05
## 
## $means
##      yield      std r      LCL      UCL   Min   Max     Q25    Q50     Q75
## A 188.7000 8.305420 8 186.1707 191.2293 172.1 198.2 185.450 189.10 195.025
## B 198.9875 9.388966 8 196.4582 201.5168 187.4 214.4 192.750 198.90 202.575
## C 207.4000 9.777817 8 204.8707 209.9293 195.5 220.4 200.125 203.85 217.175
## 
## $comparison
## NULL
## 
## $groups
##      yield groups
## C 207.4000      a
## B 198.9875      b
## A 188.7000      c
## 
## attr(,&quot;class&quot;)
## [1] &quot;group&quot;</code></pre>
<p>Our means separation results suggest the three hybrids differ in yield.</p>
</div>
<div id="scenario-6-foliar-rate-response-trial-linear-or-non-linear-regression" class="section level2 hasAnchor" number="14.6">
<h2><span class="header-section-number">14.6</span> Scenario 6: Foliar Rate-Response Trial (Linear or Non-Linear Regression)<a href="putting-it-all-together.html#scenario-6-foliar-rate-response-trial-linear-or-non-linear-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><em>We want to model how the the effect of a foliar product on yield increases with rate, from 1X to 4X.</em></p>
<p>The data are below:</p>
<table>
<thead>
<tr>
<th style="text-align:right;">
plot
</th>
<th style="text-align:left;">
block
</th>
<th style="text-align:right;">
rate
</th>
<th style="text-align:right;">
yield
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
101
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
167.1
</td>
</tr>
<tr>
<td style="text-align:right;">
102
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
168.7
</td>
</tr>
<tr>
<td style="text-align:right;">
103
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
169.5
</td>
</tr>
<tr>
<td style="text-align:right;">
104
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
165.2
</td>
</tr>
<tr>
<td style="text-align:right;">
201
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
167.2
</td>
</tr>
<tr>
<td style="text-align:right;">
202
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
164.8
</td>
</tr>
<tr>
<td style="text-align:right;">
203
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
169.4
</td>
</tr>
<tr>
<td style="text-align:right;">
204
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
170.2
</td>
</tr>
<tr>
<td style="text-align:right;">
301
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
167.8
</td>
</tr>
<tr>
<td style="text-align:right;">
302
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
170.2
</td>
</tr>
<tr>
<td style="text-align:right;">
303
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
166.1
</td>
</tr>
<tr>
<td style="text-align:right;">
304
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
169.8
</td>
</tr>
<tr>
<td style="text-align:right;">
401
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
169.3
</td>
</tr>
<tr>
<td style="text-align:right;">
402
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
171.1
</td>
</tr>
<tr>
<td style="text-align:right;">
403
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
171.5
</td>
</tr>
<tr>
<td style="text-align:right;">
404
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
165.1
</td>
</tr>
</tbody>
</table>
<p>We should start by plotting our data with a simple scatter plot so we can observe the nature of the relationship between Y and X. Do their values appear to be associated? Is their relationship linear or nonlinear?</p>
<div class="sourceCode" id="cb1055"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1055-1"><a href="putting-it-all-together.html#cb1055-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> foliar_final <span class="sc">%&gt;%</span></span>
<span id="cb1055-2"><a href="putting-it-all-together.html#cb1055-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>rate, <span class="at">y=</span>yield)) <span class="sc">+</span></span>
<span id="cb1055-3"><a href="putting-it-all-together.html#cb1055-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb1055-4"><a href="putting-it-all-together.html#cb1055-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1055-5"><a href="putting-it-all-together.html#cb1055-5" aria-hidden="true" tabindex="-1"></a>p</span></code></pre></div>
<p><img src="14-Putting-It-All_together_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<p>The response appears to be nonlinear, but we first try to fit the relationship with simple linear regression, as we learned in Unit 10. Our regression line is plotted with the data below:</p>
<div class="sourceCode" id="cb1056"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1056-1"><a href="putting-it-all-together.html#cb1056-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="14-Putting-It-All_together_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<p>We also run an analysis of variance on the regression, modelling yield as a function of rate, which produces the following results:</p>
<div class="sourceCode" id="cb1057"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1057-1"><a href="putting-it-all-together.html#cb1057-1" aria-hidden="true" tabindex="-1"></a>foliar_linear_model <span class="ot">=</span> <span class="fu">lm</span>(yield<span class="sc">~</span>rate, <span class="at">data =</span> foliar_final)</span>
<span id="cb1057-2"><a href="putting-it-all-together.html#cb1057-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(foliar_linear_model)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = yield ~ rate, data = foliar_final)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.4100 -0.6400 -0.3300  0.6637  1.9550 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 164.1500     0.6496  252.70  &lt; 2e-16 ***
## rate          1.6650     0.2372    7.02 6.06e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.061 on 14 degrees of freedom
## Multiple R-squared:  0.7787, Adjusted R-squared:  0.7629 
## F-statistic: 49.27 on 1 and 14 DF,  p-value: 6.057e-06</code></pre>
<p>Not bad. The slope (rate effect) is highly significant and the <span class="math inline">\(R^2 = 0.75\)</span>. To see whether the linear model was appropriate, however, we should plot the residuals.</p>
<div class="sourceCode" id="cb1059"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1059-1"><a href="putting-it-all-together.html#cb1059-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(foliar_linear_model, <span class="at">which =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="14-Putting-It-All_together_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<p>We see, as we might expect, the residuals are not distributed randomly around the regression line. The middle two yields are distributed mostly above the regression line, while the highest and lowest yields are distributed mostly below the regression line.</p>
<p>A linear model is probably not the best way to model our data. Lets try, instead, to fit the data with a asymptotic model as we did in Unit 11. This model, in which the value of Y increases rapidly at lower levels of X, but then plateaus at higher levels of X, is often also referred to as a monomolecular function.</p>
<div class="sourceCode" id="cb1060"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1060-1"><a href="putting-it-all-together.html#cb1060-1" aria-hidden="true" tabindex="-1"></a>foliar_monomolecular <span class="ot">=</span> stats<span class="sc">::</span><span class="fu">nls</span>(yield <span class="sc">~</span> <span class="fu">SSasymp</span>(rate,init,m,plateau), <span class="at">data=</span>foliar_final)</span>
<span id="cb1060-2"><a href="putting-it-all-together.html#cb1060-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1060-3"><a href="putting-it-all-together.html#cb1060-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(foliar_monomolecular)</span></code></pre></div>
<pre><code>## 
## Formula: yield ~ SSasymp(rate, init, m, plateau)
## 
## Parameters:
##         Estimate Std. Error t value Pr(&gt;|t|)    
## init    171.1636     1.2699 134.789   &lt;2e-16 ***
## m       159.7711     3.0120  53.044   &lt;2e-16 ***
## plateau  -0.4221     0.4880  -0.865    0.403    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.9104 on 13 degrees of freedom
## 
## Number of iterations to convergence: 0 
## Achieved convergence tolerance: 4.011e-06</code></pre>
<p>We are successful in fitting our nonlinear model. To plot it with our data, however, we have to build a new dataset that models yield as a function of rate, using our new model.</p>
<p>To do this, we first create a dataset with values of rate from 1X and 4X, in increments of tenths.</p>
<div class="sourceCode" id="cb1062"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1062-1"><a href="putting-it-all-together.html#cb1062-1" aria-hidden="true" tabindex="-1"></a>foliar_predicted <span class="ot">=</span> <span class="fu">data.frame</span>(            <span class="co"># this tells R to create a new data frame called foliar_predicted </span></span>
<span id="cb1062-2"><a href="putting-it-all-together.html#cb1062-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">rate =</span>                                  <span class="co"># this tells R to create a new column named &quot;rate&quot;</span></span>
<span id="cb1062-3"><a href="putting-it-all-together.html#cb1062-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">1</span>,<span class="at">to=</span><span class="dv">4</span>,<span class="at">by=</span><span class="fl">0.1</span>)               <span class="co"># this creates a sequence of numbers from 1 to 4, in increments of 0.1</span></span>
<span id="cb1062-4"><a href="putting-it-all-together.html#cb1062-4" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p>We then can predict yield as a function of rate, using the new model.</p>
<div class="sourceCode" id="cb1063"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1063-1"><a href="putting-it-all-together.html#cb1063-1" aria-hidden="true" tabindex="-1"></a>foliar_predicted<span class="sc">$</span>yield <span class="ot">=</span> <span class="fu">predict</span>(foliar_monomolecular, foliar_predicted)</span></code></pre></div>
<p>Finally, we can plot our curve and visually confirm it fits the data better than our linear model.</p>
<div class="sourceCode" id="cb1064"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1064-1"><a href="putting-it-all-together.html#cb1064-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="at">data =</span> foliar_predicted, <span class="fu">aes</span>(<span class="at">x=</span>rate, <span class="at">y=</span>yield), <span class="at">color=</span><span class="st">&quot;tomato&quot;</span>)</span></code></pre></div>
<p><img src="14-Putting-It-All_together_files/figure-html/unnamed-chunk-30-1.png" width="672" /></p>
</div>
<div id="scenario-7-application-map-shapefiles-and-rasters" class="section level2 hasAnchor" number="14.7">
<h2><span class="header-section-number">14.7</span> Scenario 7: Application Map (Shapefiles and Rasters)<a href="putting-it-all-together.html#scenario-7-application-map-shapefiles-and-rasters" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><em>We grid sample our field and want to visualize the results. We are particularly interested in our soil potassium results. We want to first visualize the point values, then create a raster map to predict potassium values throughout the field.</em></p>
We start by reading in the shapefile with our results.
<table>
<thead>
<tr>
<th style="text-align:right;">
obs
</th>
<th style="text-align:right;">
Sample_id
</th>
<th style="text-align:left;">
SampleDate
</th>
<th style="text-align:left;">
ReportDate
</th>
<th style="text-align:right;">
P2
</th>
<th style="text-align:left;">
Grower
</th>
<th style="text-align:left;">
Field
</th>
<th style="text-align:left;">
attribute
</th>
<th style="text-align:right;">
measure
</th>
<th style="text-align:left;">
geometry
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
29
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:left;">
10/26/2018
</td>
<td style="text-align:left;">
10/30/2018
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
Tom Besch
</td>
<td style="text-align:left;">
Folie N &amp; SE
</td>
<td style="text-align:left;">
Om
</td>
<td style="text-align:right;">
3.2
</td>
<td style="text-align:left;">
POINT (-92.78954 43.9931)
</td>
</tr>
<tr>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:left;">
10/26/2018
</td>
<td style="text-align:left;">
10/30/2018
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
Tom Besch
</td>
<td style="text-align:left;">
Folie N &amp; SE
</td>
<td style="text-align:left;">
Om
</td>
<td style="text-align:right;">
3.8
</td>
<td style="text-align:left;">
POINT (-92.7895 43.9926)
</td>
</tr>
<tr>
<td style="text-align:right;">
31
</td>
<td style="text-align:right;">
27
</td>
<td style="text-align:left;">
10/26/2018
</td>
<td style="text-align:left;">
10/30/2018
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
Tom Besch
</td>
<td style="text-align:left;">
Folie N &amp; SE
</td>
<td style="text-align:left;">
Om
</td>
<td style="text-align:right;">
3.3
</td>
<td style="text-align:left;">
POINT (-92.78942 43.98697)
</td>
</tr>
<tr>
<td style="text-align:right;">
32
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
10/26/2018
</td>
<td style="text-align:left;">
10/30/2018
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
Tom Besch
</td>
<td style="text-align:left;">
Folie N &amp; SE
</td>
<td style="text-align:left;">
Om
</td>
<td style="text-align:right;">
5.9
</td>
<td style="text-align:left;">
POINT (-92.79313 43.99245)
</td>
</tr>
<tr>
<td style="text-align:right;">
33
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:left;">
10/26/2018
</td>
<td style="text-align:left;">
10/30/2018
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
Tom Besch
</td>
<td style="text-align:left;">
Folie N &amp; SE
</td>
<td style="text-align:left;">
Om
</td>
<td style="text-align:right;">
3.1
</td>
<td style="text-align:left;">
POINT (-92.79294 43.99318)
</td>
</tr>
<tr>
<td style="text-align:right;">
34
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:left;">
10/26/2018
</td>
<td style="text-align:left;">
10/30/2018
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
Tom Besch
</td>
<td style="text-align:left;">
Folie N &amp; SE
</td>
<td style="text-align:left;">
Om
</td>
<td style="text-align:right;">
1.8
</td>
<td style="text-align:left;">
POINT (-92.79145 43.9902)
</td>
</tr>
</tbody>
</table>
<p>Our next step is to filter our results to potassium (“K”) only.</p>
<div class="sourceCode" id="cb1065"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1065-1"><a href="putting-it-all-together.html#cb1065-1" aria-hidden="true" tabindex="-1"></a>k_only <span class="ot">=</span> folie <span class="sc">%&gt;%</span></span>
<span id="cb1065-2"><a href="putting-it-all-together.html#cb1065-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(attribute<span class="sc">==</span><span class="st">&quot;K&quot;</span>)</span></code></pre></div>
<p>We want to color-code our results with green for the greatest values, yellow for intermediate values, and red for the lowest values. We can do this using the colorBin function.</p>
<div class="sourceCode" id="cb1066"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1066-1"><a href="putting-it-all-together.html#cb1066-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaflet)</span>
<span id="cb1066-2"><a href="putting-it-all-together.html#cb1066-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(grDevices)</span>
<span id="cb1066-3"><a href="putting-it-all-together.html#cb1066-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1066-4"><a href="putting-it-all-together.html#cb1066-4" aria-hidden="true" tabindex="-1"></a>pal_k <span class="ot">=</span> <span class="fu">colorBin</span>(<span class="st">&quot;RdYlGn&quot;</span>, k_only<span class="sc">$</span>measure)</span></code></pre></div>
<p>We then create our map using the leaflet() function, just as we learned in Unit 12.</p>
<div class="sourceCode" id="cb1067"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1067-1"><a href="putting-it-all-together.html#cb1067-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> k_only <span class="sc">%&gt;%</span></span>
<span id="cb1067-2"><a href="putting-it-all-together.html#cb1067-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">leaflet</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1067-3"><a href="putting-it-all-together.html#cb1067-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addTiles</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1067-4"><a href="putting-it-all-together.html#cb1067-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addCircleMarkers</span>(</span>
<span id="cb1067-5"><a href="putting-it-all-together.html#cb1067-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">fillColor =</span> <span class="sc">~</span><span class="fu">pal_k</span>(measure),</span>
<span id="cb1067-6"><a href="putting-it-all-together.html#cb1067-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">radius =</span> <span class="dv">6</span>,</span>
<span id="cb1067-7"><a href="putting-it-all-together.html#cb1067-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">weight =</span> <span class="dv">0</span>,</span>
<span id="cb1067-8"><a href="putting-it-all-together.html#cb1067-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">fillOpacity =</span> <span class="fl">0.8</span></span>
<span id="cb1067-9"><a href="putting-it-all-together.html#cb1067-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb1067-10"><a href="putting-it-all-together.html#cb1067-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addLegend</span>(<span class="at">values =</span> <span class="sc">~</span>measure,</span>
<span id="cb1067-11"><a href="putting-it-all-together.html#cb1067-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">pal =</span> pal_k)</span>
<span id="cb1067-12"><a href="putting-it-all-together.html#cb1067-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1067-13"><a href="putting-it-all-together.html#cb1067-13" aria-hidden="true" tabindex="-1"></a><span class="co">#above code won&#39;t knit -- created static image for markdown</span></span>
<span id="cb1067-14"><a href="putting-it-all-together.html#cb1067-14" aria-hidden="true" tabindex="-1"></a><span class="fu">saveWidget</span>(m, <span class="st">&quot;temp.html&quot;</span>, <span class="at">selfcontained =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1067-15"><a href="putting-it-all-together.html#cb1067-15" aria-hidden="true" tabindex="-1"></a><span class="fu">webshot</span>(<span class="st">&quot;temp.html&quot;</span>, <span class="at">cliprect =</span> <span class="st">&quot;viewport&quot;</span>)</span></code></pre></div>
<p><img src="14-Putting-It-All_together_files/figure-html/unnamed-chunk-34-1.png" width="672" /></p>
<p>Next, we want to create a raster map that predicts soil potassium levels throughout our field. We first need to define the field boundary, which we do by loading a shapefile that defines a single polygon that outlines our field.</p>
<div class="sourceCode" id="cb1068"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1068-1"><a href="putting-it-all-together.html#cb1068-1" aria-hidden="true" tabindex="-1"></a>boundary <span class="ot">=</span> <span class="fu">st_read</span>(<span class="st">&quot;data-unit-14/Folie N &amp;SE_boundary.shp&quot;</span>, <span class="at">quiet=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p>We then use that boundary polygon to create a grid. Each cell of this grid will be filled in when we create our raster.</p>
<div class="sourceCode" id="cb1069"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1069-1"><a href="putting-it-all-together.html#cb1069-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stars)</span>
<span id="cb1069-2"><a href="putting-it-all-together.html#cb1069-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1069-3"><a href="putting-it-all-together.html#cb1069-3" aria-hidden="true" tabindex="-1"></a><span class="do">### make grid</span></span>
<span id="cb1069-4"><a href="putting-it-all-together.html#cb1069-4" aria-hidden="true" tabindex="-1"></a>grd <span class="ot">=</span> <span class="fu">st_bbox</span>(boundary) <span class="sc">%&gt;%</span></span>
<span id="cb1069-5"><a href="putting-it-all-together.html#cb1069-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_stars</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1069-6"><a href="putting-it-all-together.html#cb1069-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_crop</span>(boundary) </span></code></pre></div>
<p>Each cell in our raster that does not coincide with a test value will be predicted as the mean of the values of other soil test points. Since soils that are closer together are more alike than those that are farther apart, soil test points that are closer to the estimated cell will be weighted more heavily in calculating the mean than those more distant. How should they be weighted?</p>
<p>To answer this, we fit a variogram to the data. The variogram describes how the correlation between points changes with distance.</p>
<div class="sourceCode" id="cb1070"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1070-1"><a href="putting-it-all-together.html#cb1070-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gstat)</span>
<span id="cb1070-2"><a href="putting-it-all-together.html#cb1070-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1070-3"><a href="putting-it-all-together.html#cb1070-3" aria-hidden="true" tabindex="-1"></a>v <span class="ot">=</span> <span class="fu">variogram</span>(measure<span class="sc">~</span><span class="dv">1</span>, k_only)</span>
<span id="cb1070-4"><a href="putting-it-all-together.html#cb1070-4" aria-hidden="true" tabindex="-1"></a>m <span class="ot">=</span> <span class="fu">fit.variogram</span>(v, <span class="fu">vgm</span>(<span class="st">&quot;Sph&quot;</span>))</span>
<span id="cb1070-5"><a href="putting-it-all-together.html#cb1070-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(v, <span class="at">model =</span> m)</span></code></pre></div>
<p><img src="14-Putting-It-All_together_files/figure-html/unnamed-chunk-37-1.png" width="672" /></p>
<p>We are now able to interpolate our data with krigining, which incorporates the results of our variogram in weighting the effect of sample points in the estimate of a cell value.</p>
<div class="sourceCode" id="cb1071"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1071-1"><a href="putting-it-all-together.html#cb1071-1" aria-hidden="true" tabindex="-1"></a>kriged_data <span class="ot">=</span> gstat<span class="sc">::</span><span class="fu">krige</span>(<span class="at">formula =</span> measure<span class="sc">~</span><span class="dv">1</span>, k_only, grd, <span class="at">model=</span>m)</span></code></pre></div>
<pre><code>## [using ordinary kriging]</code></pre>
<p>We finish by plotting our kriged data using leaflet().</p>
<div class="sourceCode" id="cb1073"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1073-1"><a href="putting-it-all-together.html#cb1073-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb1073-2"><a href="putting-it-all-together.html#cb1073-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leafem)</span>
<span id="cb1073-3"><a href="putting-it-all-together.html#cb1073-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1073-4"><a href="putting-it-all-together.html#cb1073-4" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> kriged_data <span class="sc">%&gt;%</span></span>
<span id="cb1073-5"><a href="putting-it-all-together.html#cb1073-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">leaflet</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1073-6"><a href="putting-it-all-together.html#cb1073-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addTiles</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1073-7"><a href="putting-it-all-together.html#cb1073-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addStarsImage</span>(<span class="at">opacity =</span> <span class="fl">0.5</span>,</span>
<span id="cb1073-8"><a href="putting-it-all-together.html#cb1073-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">colors=</span><span class="st">&quot;RdYlGn&quot;</span>) </span>
<span id="cb1073-9"><a href="putting-it-all-together.html#cb1073-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1073-10"><a href="putting-it-all-together.html#cb1073-10" aria-hidden="true" tabindex="-1"></a><span class="co">#above code won&#39;t knit -- created static image for markdown</span></span>
<span id="cb1073-11"><a href="putting-it-all-together.html#cb1073-11" aria-hidden="true" tabindex="-1"></a><span class="fu">saveWidget</span>(m, <span class="st">&quot;temp.html&quot;</span>, <span class="at">selfcontained =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1073-12"><a href="putting-it-all-together.html#cb1073-12" aria-hidden="true" tabindex="-1"></a><span class="fu">webshot</span>(<span class="st">&quot;temp.html&quot;</span>, <span class="at">cliprect =</span> <span class="st">&quot;viewport&quot;</span>)</span></code></pre></div>
<p><img src="14-Putting-It-All_together_files/figure-html/unnamed-chunk-39-1.png" width="672" /></p>
</div>
<div id="scenario-8-yield-prediction-multiple-linear-regression-and-other-predictive-models" class="section level2 hasAnchor" number="14.8">
<h2><span class="header-section-number">14.8</span> Scenario 8: Yield Prediction (Multiple Linear Regression and other Predictive Models)<a href="putting-it-all-together.html#scenario-8-yield-prediction-multiple-linear-regression-and-other-predictive-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><em>We want to predict the yield for a particular hybrid across 676 midwestern counties, based on over 300 observations of that hybrid.</em></p>
<p>We start by reading in the shapefile with our hybrid data.</p>
<pre><code>## Reading layer `hybrid_data&#39; from data source 
##   `C:\ds_ag_professionals\data-unit-14\hybrid_data.shp&#39; using driver `ESRI Shapefile&#39;
## Simple feature collection with 4578 features and 4 fields
## Geometry type: POINT
## Dimension:     XY
## Bounding box:  xmin: -104.8113 ymin: 37.56348 xmax: -81.08706 ymax: 46.24
## Geodetic CRS:  WGS 84</code></pre>
<pre><code>## Simple feature collection with 6 features and 4 fields
## Geometry type: POINT
## Dimension:     XY
## Bounding box:  xmin: -99.80072 ymin: 42.54919 xmax: -89.77396 ymax: 43.77493
## Geodetic CRS:  WGS 84
##      book_name year attribute    value                   geometry
## 1     ADAMS-MN 2016   bu_acre 215.4100 POINT (-92.26931 43.57388)
## 2     Adams-WI 2016   bu_acre 257.0930 POINT (-89.77396 43.77493)
## 3 Ainsworth-NE 2016   bu_acre 236.5837 POINT (-99.80072 42.55031)
## 4 Ainsworth-NE 2017   bu_acre 244.3435 POINT (-99.80072 42.55031)
## 5 Ainsworth-NE 2019   bu_acre 220.0456 POINT (-99.79738 42.54919)
## 6    Algona-IA 2016   bu_acre 216.0600 POINT (-94.28736 42.97575)</code></pre>
<p>The attributes are organized in the long form so we will want to “spread” or pivot them to the wide form first.</p>
<div class="sourceCode" id="cb1076"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1076-1"><a href="putting-it-all-together.html#cb1076-1" aria-hidden="true" tabindex="-1"></a>hybrid_wide <span class="ot">=</span> hybrid <span class="sc">%&gt;%</span></span>
<span id="cb1076-2"><a href="putting-it-all-together.html#cb1076-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(attribute, value)</span>
<span id="cb1076-3"><a href="putting-it-all-together.html#cb1076-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(hybrid_wide)</span></code></pre></div>
<pre><code>## Simple feature collection with 6 features and 16 fields
## Geometry type: POINT
## Dimension:     XY
## Bounding box:  xmin: -99.80072 ymin: 42.54919 xmax: -89.77396 ymax: 43.77493
## Geodetic CRS:  WGS 84
##      book_name year  bu_acre      clay       om prcp_0_500 prcp_1001_1500
## 1     ADAMS-MN 2016 215.4100 23.939049 149.7867        152            167
## 2     Adams-WI 2016 257.0930  9.899312 438.3402        140            112
## 3 Ainsworth-NE 2016 236.5837 11.701055 143.7150         97             63
## 4 Ainsworth-NE 2017 244.3435 11.701055 143.7150        148             16
## 5 Ainsworth-NE 2019 220.0456 11.701055 143.7150        234             22
## 6    Algona-IA 2016 216.0600 25.283112 480.4145         96            144
##   prcp_1501_2000 prcp_501_1000     sand     silt tmean_0_500 tmean_1001_1500
## 1             84           122 16.96170 59.09925    14.32143        21.91071
## 2            152            39 78.38254 11.71815    16.74286        22.30357
## 3             79            50 69.87984 18.41910    15.72857        22.38095
## 4            212            12 69.87984 18.41910    15.96428        26.11905
## 5            142           116 69.87984 18.41910    16.32143        23.82143
## 6             55            72 37.38857 37.32832    16.19286        21.26191
##   tmean_1501_2000 tmean_501_1000      whc                   geometry
## 1        22.05952       21.45238 27.98555 POINT (-92.26931 43.57388)
## 2        21.83333       20.13095 15.67212 POINT (-89.77396 43.77493)
## 3        23.77381       24.00000 18.41579 POINT (-99.80072 42.55031)
## 4        21.34821       20.64286 18.41579 POINT (-99.80072 42.55031)
## 5        22.46429       21.69048 18.41579 POINT (-99.79738 42.54919)
## 6        22.89286       23.32143 33.21381 POINT (-94.28736 42.97575)</code></pre>
<p>Similarly, lets load in the county data. Like the hybrid dataset, it is in long form, so lets again spread or pivot it to the long form so that the attributes each have their own column.</p>
<div class="sourceCode" id="cb1078"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1078-1"><a href="putting-it-all-together.html#cb1078-1" aria-hidden="true" tabindex="-1"></a>county_climates <span class="ot">=</span> <span class="fu">st_read</span>(<span class="st">&quot;data-unit-14/county_climates.shp&quot;</span>)</span></code></pre></div>
<pre><code>## Reading layer `county_climates&#39; from data source 
##   `C:\ds_ag_professionals\data-unit-14\county_climates.shp&#39; using driver `ESRI Shapefile&#39;
## Simple feature collection with 8788 features and 8 fields
## Geometry type: MULTIPOLYGON
## Dimension:     XY
## Bounding box:  xmin: -106.1954 ymin: 36.99782 xmax: -80.51869 ymax: 47.24051
## Geodetic CRS:  WGS 84</code></pre>
<div class="sourceCode" id="cb1080"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1080-1"><a href="putting-it-all-together.html#cb1080-1" aria-hidden="true" tabindex="-1"></a>county_climates_wide <span class="ot">=</span> county_climates <span class="sc">%&gt;%</span></span>
<span id="cb1080-2"><a href="putting-it-all-together.html#cb1080-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(attribt, value)</span>
<span id="cb1080-3"><a href="putting-it-all-together.html#cb1080-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1080-4"><a href="putting-it-all-together.html#cb1080-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(county_climates_wide)</span></code></pre></div>
<pre><code>## Simple feature collection with 6 features and 19 fields
## Geometry type: MULTIPOLYGON
## Dimension:     XY
## Bounding box:  xmin: -105.6932 ymin: 38.61245 xmax: -102.0451 ymax: 40.26278
## Geodetic CRS:  WGS 84
##   stco stt_bbv stt_fps           cnty_nm fps_cls  stat_nm     clay       om
## 1 8001      CO      08      Adams County      H1 Colorado 21.88855 102.0773
## 2 8005      CO      08   Arapahoe County      H1 Colorado 23.87947 102.4535
## 3 8013      CO      08    Boulder County      H1 Colorado 25.83687 106.2404
## 4 8017      CO      08   Cheyenne County      H1 Colorado 23.67021 105.8340
## 5 8039      CO      08     Elbert County      H1 Colorado 22.00638 117.1232
## 6 8063      CO      08 Kit Carson County      H1 Colorado 24.78930 159.3644
##   prcp_0_500 prcp_1001_1500 prcp_1501_2000 prcp_501_1000     sand     silt
## 1   72.05263       44.15789       43.84211      31.68421 47.83218 30.27927
## 2   58.20000       43.20000       33.80000      17.00000 41.83093 34.28960
## 3  100.38462       47.84615       67.46154      58.07692 42.52472 31.63841
## 4   57.42105       54.52632       61.73684      37.26316 25.24085 51.08894
## 5   82.35714       57.64286       47.71429      49.28571 45.78082 32.21280
## 6   68.05263       54.26316       76.52632      43.36842 26.70159 48.50911
##   tmean_0_500 tmean_1001_1500 tmean_1501_2000 tmean_501_1000      whc
## 1    16.06967        24.17904        22.77083       21.65316 22.03449
## 2    15.64571        24.02857        22.46845       21.42024 21.34191
## 3    12.94062        18.60742        13.54932       19.00073 22.04795
## 4    17.02484        24.85072        24.18186       22.41526 30.14545
## 5    14.86390        22.27912        20.54928       20.41850 19.80896
## 6    16.74041        24.50439        23.56375       22.10329 26.92315
##                         geometry
## 1 MULTIPOLYGON (((-105.0529 3...
## 2 MULTIPOLYGON (((-105.0534 3...
## 3 MULTIPOLYGON (((-105.0826 3...
## 4 MULTIPOLYGON (((-103.1725 3...
## 5 MULTIPOLYGON (((-104.6606 3...
## 6 MULTIPOLYGON (((-103.1631 3...</code></pre>
<p>First, lets plot the locations of our hybrid trials:</p>
<p><img src="14-Putting-It-All_together_files/figure-html/unnamed-chunk-43-1.png" width="672" />
We see our trials were conducted mostly in northern Iowa and southern Minnesota, but also in several other states. We will want to constrain our predictions to counties in this general area. That requires a few steps that we didn’t cover this semester (the very curious can look up “convex hulls”). Our county dataset has been limited to the appropriate counties for our predictions:</p>
<p><img src="14-Putting-It-All_together_files/figure-html/unnamed-chunk-44-1.png" width="672" /></p>
<p>Our next step is to develop our random forest model to predict yield. Recall that the predictor variables in a random forest model are called features. Our data has the following features:</p>
<table>
<thead>
<tr>
<th style="text-align:left;">
attribute
</th>
<th style="text-align:left;">
description
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
clay
</td>
<td style="text-align:left;">
% clay
</td>
</tr>
<tr>
<td style="text-align:left;">
om
</td>
<td style="text-align:left;">
% organic matter
</td>
</tr>
<tr>
<td style="text-align:left;">
prcp_0_500
</td>
<td style="text-align:left;">
precip from 0 to 500 GDD
</td>
</tr>
<tr>
<td style="text-align:left;">
prcp_1001_1500
</td>
<td style="text-align:left;">
precip from 1001 to 1500 GDD
</td>
</tr>
<tr>
<td style="text-align:left;">
prcp_1501_2000
</td>
<td style="text-align:left;">
precip from 1501 to 2000 GDD
</td>
</tr>
<tr>
<td style="text-align:left;">
prcp_501_1000
</td>
<td style="text-align:left;">
precip from 501 to 1000 GDD
</td>
</tr>
<tr>
<td style="text-align:left;">
sand
</td>
<td style="text-align:left;">
% sand
</td>
</tr>
<tr>
<td style="text-align:left;">
silt
</td>
<td style="text-align:left;">
% silt
</td>
</tr>
<tr>
<td style="text-align:left;">
tmean_0_500
</td>
<td style="text-align:left;">
mean temp from 0 to 500 GDD
</td>
</tr>
<tr>
<td style="text-align:left;">
tmean_1001_1500
</td>
<td style="text-align:left;">
mean temp from 1001 to 1500 GDD
</td>
</tr>
<tr>
<td style="text-align:left;">
tmean_1501_2000
</td>
<td style="text-align:left;">
mean temp from 1501 to 2000 GDD
</td>
</tr>
<tr>
<td style="text-align:left;">
tmean_501_1000
</td>
<td style="text-align:left;">
mean temp from 501 to 1000 GDD
</td>
</tr>
<tr>
<td style="text-align:left;">
whc
</td>
<td style="text-align:left;">
water holding capacity
</td>
</tr>
</tbody>
</table>
<p>GDD are growing degree days accumulated from the historical average date at which 50% of the corn crop has been planted in each county. For example, prcp_0_500 is the cumulative precipitation from 0 to 500 GDD after planting. This would correspond with germination and seedling emergence.</p>
<p>We run our random forest the same as we learned in Unit 13. We have a couple of extraneous columns (book_name and year) in our hybrid_wide dataset. It is also a shapefile; we need to drop the geometry column and convert it into a dataframe before using it. We will do that first.</p>
<div class="sourceCode" id="cb1082"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1082-1"><a href="putting-it-all-together.html#cb1082-1" aria-hidden="true" tabindex="-1"></a>hybrid_df <span class="ot">=</span> hybrid_wide <span class="sc">%&gt;%</span></span>
<span id="cb1082-2"><a href="putting-it-all-together.html#cb1082-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_drop_geometry</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1082-3"><a href="putting-it-all-together.html#cb1082-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(book_name, year))</span></code></pre></div>
<p>We will use 10-fold cross validation (indicated by the “repeatedcv” option in our trainControl() function below.)</p>
<div class="sourceCode" id="cb1083"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1083-1"><a href="putting-it-all-together.html#cb1083-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb1083-2"><a href="putting-it-all-together.html#cb1083-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(randomForest)</span>
<span id="cb1083-3"><a href="putting-it-all-together.html#cb1083-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1083-4"><a href="putting-it-all-together.html#cb1083-4" aria-hidden="true" tabindex="-1"></a>ctrl <span class="ot">=</span> <span class="fu">trainControl</span>(<span class="at">method=</span><span class="st">&quot;repeatedcv&quot;</span>, <span class="at">number=</span><span class="dv">10</span>, <span class="at">repeats =</span> <span class="dv">1</span>)</span></code></pre></div>
<p>We can now fit our random forest model to the data.</p>
<div class="sourceCode" id="cb1084"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1084-1"><a href="putting-it-all-together.html#cb1084-1" aria-hidden="true" tabindex="-1"></a>hybridFit <span class="ot">=</span> <span class="fu">train</span>(bu_acre <span class="sc">~</span> .,</span>
<span id="cb1084-2"><a href="putting-it-all-together.html#cb1084-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> hybrid_df,</span>
<span id="cb1084-3"><a href="putting-it-all-together.html#cb1084-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">method =</span> <span class="st">&quot;rf&quot;</span>,</span>
<span id="cb1084-4"><a href="putting-it-all-together.html#cb1084-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">trControl =</span> ctrl)</span>
<span id="cb1084-5"><a href="putting-it-all-together.html#cb1084-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1084-6"><a href="putting-it-all-together.html#cb1084-6" aria-hidden="true" tabindex="-1"></a>hybridFit</span></code></pre></div>
<pre><code>## Random Forest 
## 
## 327 samples
##  13 predictor
## 
## No pre-processing
## Resampling: Cross-Validated (10 fold, repeated 1 times) 
## Summary of sample sizes: 295, 294, 295, 294, 295, 295, ... 
## Resampling results across tuning parameters:
## 
##   mtry  RMSE      Rsquared   MAE     
##    2    34.52569  0.1436353  25.86010
##    7    34.95068  0.1426655  26.24718
##   13    35.42862  0.1309118  26.53165
## 
## RMSE was used to select the optimal model using the smallest value.
## The final value used for the model was mtry = 2.</code></pre>
<p>These values aren’t great. The <span class="math inline">\(R^2\)</span> of the optimal model (top line, mtry = 2) is only about 0.16 and the root mean square error is above 33 bushels. For simplicity in this example, we left out several additional environmental features. We might consider adding those back in and re-running the model.</p>
<p>Nonetheless, lets’ use our fit random forest model to predict yield across each county in our prediction space.</p>
<div class="sourceCode" id="cb1086"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1086-1"><a href="putting-it-all-together.html#cb1086-1" aria-hidden="true" tabindex="-1"></a>county_climates_wide<span class="sc">$</span>yield <span class="ot">=</span> <span class="fu">predict</span>(hybridFit, county_climates_wide)</span></code></pre></div>
<p>Finally, we can plot the results. We will again use a red-yellow-gree scheme to code counties by yield.</p>
<div class="sourceCode" id="cb1087"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1087-1"><a href="putting-it-all-together.html#cb1087-1" aria-hidden="true" tabindex="-1"></a>pal_yield <span class="ot">=</span> <span class="fu">colorBin</span>(<span class="st">&quot;RdYlGn&quot;</span>, county_climates_wide<span class="sc">$</span>yield)</span>
<span id="cb1087-2"><a href="putting-it-all-together.html#cb1087-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1087-3"><a href="putting-it-all-together.html#cb1087-3" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> county_climates_wide <span class="sc">%&gt;%</span></span>
<span id="cb1087-4"><a href="putting-it-all-together.html#cb1087-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">leaflet</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1087-5"><a href="putting-it-all-together.html#cb1087-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addTiles</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1087-6"><a href="putting-it-all-together.html#cb1087-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addPolygons</span>(</span>
<span id="cb1087-7"><a href="putting-it-all-together.html#cb1087-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb1087-8"><a href="putting-it-all-together.html#cb1087-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">fillColor=</span><span class="sc">~</span><span class="fu">pal_yield</span>(yield),</span>
<span id="cb1087-9"><a href="putting-it-all-together.html#cb1087-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">weight=</span><span class="dv">1</span>,</span>
<span id="cb1087-10"><a href="putting-it-all-together.html#cb1087-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">fillOpacity =</span> <span class="fl">0.8</span>,</span>
<span id="cb1087-11"><a href="putting-it-all-together.html#cb1087-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">popup =</span> <span class="fu">paste</span>(county_climates_wide<span class="sc">$</span>cnty_nm, <span class="st">&quot;&lt;br&gt;&quot;</span>,</span>
<span id="cb1087-12"><a href="putting-it-all-together.html#cb1087-12" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;Yield =&quot;</span>, <span class="fu">as.character</span>(<span class="fu">round</span>(county_climates_wide<span class="sc">$</span>yield,<span class="dv">1</span>)))) <span class="sc">%&gt;%</span></span>
<span id="cb1087-13"><a href="putting-it-all-together.html#cb1087-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addLegend</span>(<span class="at">values =</span> <span class="sc">~</span>yield,</span>
<span id="cb1087-14"><a href="putting-it-all-together.html#cb1087-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">pal =</span> pal_yield)</span>
<span id="cb1087-15"><a href="putting-it-all-together.html#cb1087-15" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb1087-16"><a href="putting-it-all-together.html#cb1087-16" aria-hidden="true" tabindex="-1"></a><span class="co">#above code won&#39;t knit -- created static image for markdown</span></span>
<span id="cb1087-17"><a href="putting-it-all-together.html#cb1087-17" aria-hidden="true" tabindex="-1"></a><span class="fu">saveWidget</span>(m, <span class="st">&quot;temp.html&quot;</span>, <span class="at">selfcontained =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1087-18"><a href="putting-it-all-together.html#cb1087-18" aria-hidden="true" tabindex="-1"></a><span class="fu">webshot</span>(<span class="st">&quot;temp.html&quot;</span>, <span class="at">cliprect =</span> <span class="st">&quot;viewport&quot;</span>)</span></code></pre></div>
<p><img src="14-Putting-It-All_together_files/figure-html/unnamed-chunk-50-1.png" width="672" />
Our hybrid is predicted to yield best in northern Iowa, southern Minnesota, Wisconsin, and Northern Illinois. It is predicted to perform less well in Western Ohio and Kansas.</p>
<p>One last question: of our features, which had the greatest effect on the yield of this hybrid? We can answer that by running the vip() function with our model.</p>
<div class="sourceCode" id="cb1088"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1088-1"><a href="putting-it-all-together.html#cb1088-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vip)</span>
<span id="cb1088-2"><a href="putting-it-all-together.html#cb1088-2" aria-hidden="true" tabindex="-1"></a><span class="fu">vip</span>(hybridFit)</span></code></pre></div>
<p><img src="14-Putting-It-All_together_files/figure-html/unnamed-chunk-51-1.png" width="672" /></p>
<p>We see that mean temperature during later-vegetative (1001-1500 GDD) and reproductive (1501-2000 GDD) phases had the most effect in our model, followed by clay content.</p>
</div>
<div id="summary-3" class="section level2 hasAnchor" number="14.9">
<h2><span class="header-section-number">14.9</span> Summary<a href="putting-it-all-together.html#summary-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>And that is it for our whirlwind review of <em>Data Science for Agricultural Professionals</em>. While each scenario is discussed briefly, it is my hope that seeing the major tools we have learned side-by-side will give you a better sense where to start with your analyses.</p>
<p>For the sake of brevity, we didn’t cover every possible combination of these tools (for example, you should also inspect data distributions and perform means separation when working with factorial trials as well as simpler, single-factor trials). Once you have identified the general analysis to use, I encourage you to go back to the individual units for a more complete “recipe” how to conduct your analysis.</p>
<p>In fact, feel free to as a “cookbook” (in fact, several R texts label themselves as such), returning to it as needed to whip up a quick serving of t-tests, LSDs, or yield maps. Few of us ever memorize more than a small amount of material. Better to remember where to look it up in a hurry.</p>
<p>I hope you have enjoyed this text or, at least, found several pieces of it that can support you in your future efforts. I welcome your feedback and suggestions how it might be improved. Thank you.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="machine-learning.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/14-Putting-It-All_together.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
